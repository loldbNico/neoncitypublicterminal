    /* MDT view: empty workspace */
    .mdtstage{
      position: absolute;
      left: 0;
      right: 0;
      top: var(--topbar-h);
      bottom: 0;
      overflow: hidden;
      z-index: 90;
      background:
        radial-gradient(900px 520px at 26% 0%, var(--mdt-accent-fade-1, rgba(96,143,255,.08)), rgba(0,0,0,0) 62%),
        radial-gradient(820px 520px at 70% 0%, var(--mdt-accent-fade-2, rgba(96,143,255,.05)), rgba(0,0,0,0) 60%),
        linear-gradient(180deg, rgba(1,6,27,.66) 0%, rgba(0,0,0,.90) 100%);
    }

    .mdt{
      position: absolute;
      inset: 12px 14px 14px;
      display: grid;
      grid-template-columns: 260px 1fr;
      gap: 12px;
      border: 1px solid var(--mdt-border, rgba(96,143,255,.14));
      background: rgba(0,0,0,.12);
      box-shadow:
        0 0 0 1px rgba(0,0,0,.72) inset,
        0 0 34px var(--mdt-glow, rgba(96,143,255,.06));
      overflow: hidden;
    }

    .mdtSide{
      border-right: 1px solid var(--mdt-border, rgba(96,143,255,.14));
      background:
        radial-gradient(820px 420px at 30% 0%, var(--mdt-accent-fade-3, rgba(96,143,255,.08)), rgba(0,0,0,0) 60%),
        linear-gradient(180deg, rgba(0,0,0,.28), rgba(0,0,0,.60));
      overflow: hidden;
      display: grid;
      grid-template-rows: auto auto 1fr;
    }

    .mdtSideHead{
      padding: 14px 14px 10px;
      border-bottom: 1px solid var(--mdt-border, rgba(96,143,255,.14));
      font-weight: 900;
      letter-spacing: 2.6px;
      text-transform: uppercase;
      color: var(--mdt-accent-text, rgba(96,143,255,.92));
    }

    .mdtCats{
      padding: 10px 10px 12px;
      overflow: auto;
      scrollbar-color: var(--mdt-scrollbar, rgba(96,143,255,.35)) rgba(0,0,0,.28);
    }

    .mdtCat{
      width: 100%;
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 10px;
      align-items: center;
      padding: 10px 10px;
      margin: 6px 0;
      border: 1px solid var(--mdt-border, rgba(96,143,255,.18));
      background: rgba(0,0,0,.18);
      color: rgba(215,230,255,.78);
      text-transform: uppercase;
      letter-spacing: 1.2px;
      cursor: var(--cur-link), pointer;
      box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset;
      transition: border-color .12s ease, color .12s ease, transform .12s ease, box-shadow .12s ease;
    }

    .mdtCat:hover{
      border-color: var(--mdt-border-strong, rgba(96,143,255,.55));
      color: var(--mdt-accent-strong-text, rgba(96,143,255,.96));
      box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset, 0 0 24px var(--mdt-glow-strong, rgba(96,143,255,.12));
    }

    /* Highlight "finished" categories with a subtle gold glint */
    .mdtCat.mdtCat--arrests,
    .mdtCat.mdtCat--citizen_profiles,
    .mdtCat.mdtCat--organizations{
      border-color: rgba(255, 205, 85, .38);
      color: rgba(255, 232, 170, .90);
      box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset, 0 0 18px rgba(255, 200, 80, .10);
      position: relative;
      overflow: hidden;
    }

    .mdtCat.mdtCat--arrests:hover,
    .mdtCat.mdtCat--citizen_profiles:hover,
    .mdtCat.mdtCat--organizations:hover{
      border-color: rgba(255, 210, 90, .68);
      color: rgba(255, 242, 205, .98);
      box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset, 0 0 26px rgba(255, 200, 80, .16);
    }

    .mdtCat.mdtCat--arrests::after,
    .mdtCat.mdtCat--citizen_profiles::after,
    .mdtCat.mdtCat--organizations::after{
      content: '';
      position: absolute;
      inset: -2px;
      background:
        linear-gradient(
          120deg,
          rgba(255, 210, 90, 0) 0%,
          rgba(255, 210, 90, .12) 22%,
          rgba(255, 245, 200, .22) 32%,
          rgba(255, 210, 90, .10) 42%,
          rgba(255, 210, 90, 0) 60%
        );
      transform: translateX(-140%);
      pointer-events: none;
      animation: mdtGoldGlint 7.5s ease-in-out infinite;
      mix-blend-mode: screen;
      opacity: .9;
    }

    @keyframes mdtGoldGlint{
      0%{ transform: translateX(-140%); }
      14%{ transform: translateX(140%); }
      100%{ transform: translateX(140%); }
    }

    .mdtCatAdd{
      width: 26px;
      height: 26px;
      border: 1px solid var(--mdt-border, rgba(96,143,255,.25));
      background: rgba(0,0,0,.25);
      color: var(--mdt-accent-text, rgba(96,143,255,.75));
      cursor: var(--cur-link), pointer;
      line-height: 1;
      font-weight: 900;
      box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset;
    }

    .mdtCatAdd:hover{
      border-color: var(--mdt-border-strong, rgba(96,143,255,.60));
      color: var(--mdt-accent-strong-text, rgba(96,143,255,.98));
    }

    .mdtMain{
      display: grid;
      grid-template-rows: auto auto 1fr;
      overflow: hidden;
    }

.mdtTop{
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 10px 10px 0;
      border-bottom: 1px solid var(--mdt-border, rgba(96,143,255,.14));
      background: rgba(0,0,0,.10);
      position: relative;
    }
 
    .mdtTabstrip{
      display: flex;
      gap: 10px;
      align-items: flex-start;
      overflow: auto;
      padding-bottom: 8px;
      scrollbar-color: var(--mdt-scrollbar, rgba(96,143,255,.35)) rgba(0,0,0,.28);
      color: var(--mdt-accent-text, rgba(215,230,255,.72));
    }



    .mdtModeToggle{
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 6px;
      margin: 0 0 10px 10px;
    }

    .mdtModeBtn{
      height: 28px;
      border: 1px solid var(--mdt-border, rgba(96,143,255,.22));
      background: rgba(0,0,0,.24);
      color: var(--mdt-accent-text, rgba(215,230,255,.72));
      text-transform: uppercase;
      letter-spacing: 1.2px;
      font-size: 11px;
      cursor: var(--cur-link), pointer;
      box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset;
      transition: border-color .12s ease, color .12s ease, background .12s ease, box-shadow .12s ease;
    }

    .mdtModeBtn:hover{
      border-color: var(--mdt-border-strong, rgba(96,143,255,.55));
      color: var(--mdt-accent-strong-text, rgba(215,230,255,.94));
      box-shadow: 0 0 12px var(--mdt-glow-strong, rgba(96,143,255,.18));
    }

    .mdtModeBtn.on{
      border-color: var(--mdt-border-strong, rgba(96,143,255,.85));
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,.40));
      color: var(--mdt-accent-strong-text, rgba(238,244,255,.98));
      font-weight: 800;
      box-shadow: 0 0 18px var(--mdt-glow-strong, rgba(96,143,255,.22));
    }

    .mdtSideHead + .mdtModeToggle{
      margin-top: 10px;
    }

    .mdtSide .mdtModeToggle{
      padding: 0 10px;
    }

    .mdtTabstrip{
      display: flex;
      gap: 10px;
      align-items: flex-end;
      overflow: auto;
      padding-bottom: 8px;
      scrollbar-color: rgba(96,143,255,.35) rgba(0,0,0,.28);
    }

    .mdtTab{
      appearance: none;
      border: none;
      padding: 0 4px 4px;
      margin: 0;
      background: rgba(0,0,0,.18);
      cursor: var(--cur-move), grab;
      color: var(--mdt-accent-text, rgba(215,230,255,.68));
      text-transform: uppercase;
      letter-spacing: 1.2px;
      font-size: 12px;
      min-height: 32px;
      display: flex;
      align-items: center;
      gap: 10px;
      border: 1px solid var(--mdt-border, rgba(96,143,255,.18));
      border-bottom-width: 2px;
      transition: color .12s ease, border-color .12s ease, transform .12s ease, box-shadow .12s ease;
      white-space: nowrap;
      position: relative;
      user-select: none;
      touch-action: pan-y;
    }

    .mdtTab::after{
      content: '';
      position: absolute;
      inset: 0;
      pointer-events: none;
      border: 1px solid transparent;
      transition: border-color .12s ease;
    }

    .mdtTabClose{
      width: 22px;
      height: 22px;
      border: 1px solid var(--mdt-border, rgba(96,143,255,.20));
      background: rgba(0,0,0,.22);
      color: var(--mdt-accent-text, rgba(215,230,255,.75));
      cursor: var(--cur-link), pointer;
      line-height: 1;
      font-weight: 900;
      box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset;
      padding: 0;
      pointer-events: auto;
      flex-shrink: 0;
    }

    .mdtTabClose:hover{
      border-color: var(--mdt-border-strong, rgba(96,143,255,.75));
      color: var(--mdt-accent-strong-text, rgba(96,143,255,.98));
    }

    .mdtTab:hover{ color: var(--mdt-accent-strong-text, rgba(96,143,255,.95)); box-shadow: 0 8px 16px rgba(0,0,0,.24); transform: translateY(-2px); }

    .mdtTab.on{
      color: var(--mdt-accent-strong-text, rgba(96,143,255,.98));
      border-color: var(--mdt-border-strong, rgba(96,143,255,.75));
      border-bottom-color: var(--mdt-border-strong, rgba(96,143,255,.85));
      font-weight: 800;
      box-shadow: 0 10px 26px rgba(0,0,0,.35), 0 0 24px var(--mdt-glow-strong, rgba(96,143,255,.18));
      transform: translateY(-2px);
      pointer-events: auto;
    }

    .mdtTabAdd{
      width: 30px;
      height: 30px;
      border: 1px solid rgba(96,143,255,.25);
      background: rgba(0,0,0,.25);
      color: rgba(96,143,255,.80);
      cursor: var(--cur-link), pointer;
      font-weight: 900;
      line-height: 1;
      box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset;
      margin-bottom: 8px;
    }

    .mdtTabAdd:hover{
      border-color: rgba(96,143,255,.60);
      color: rgba(96,143,255,.98);
    }

    .mdtNav{
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px;
    }
 
    .mdtBack,
    .mdtFwd,
    .mdtRestore{
      width: 34px;
      height: 30px;
      border: 1px solid var(--mdt-border, rgba(96,143,255,.25));
      background: rgba(0,0,0,.25);
      color: var(--mdt-accent-text, rgba(96,143,255,.80));
      cursor: var(--cur-link), pointer;
      font-weight: 900;
      line-height: 1;
      box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset;
    }
 
    .mdtBack:disabled,
    .mdtFwd:disabled,
    .mdtRestore:disabled{
      opacity: .35;
      cursor: var(--cur-default), default;
    }


    .mdtView{
      position: relative;
      overflow: auto;
      padding: 14px;
      border-top: 1px solid rgba(96,143,255,.10);
    }

    .mdtPanel{
      border: 1px solid rgba(96,143,255,.14);
      background: rgba(0,0,0,.18);
      box-shadow: 0 0 0 1px rgba(0,0,0,.72) inset;
      padding: 14px;
      min-height: 120px;
    }

    .mdtH{
      font-weight: 900;
      letter-spacing: 2.2px;
      text-transform: uppercase;
      color: var(--mdt-accent-strong-text, rgba(96,143,255,.92));
      margin-bottom: 10px;
    }

    .mdtLinkish{ cursor: var(--cur-link), pointer; text-decoration: underline; text-decoration-color: var(--mdt-accent-1, rgba(96,143,255,.72)); }

    .mdtP{
      color: rgba(215,230,255,.70);
      letter-spacing: .6px;
      line-height: 1.4;
    }

    .mdtSubH{
      font-weight: 700;
      letter-spacing: 1.6px;
      text-transform: uppercase;
      color: var(--mdt-accent-text, rgba(96,143,255,.78));
      margin: 18px 0 10px;
      font-size: 12px;
    }

    /* Tab drag-to-reorder */
    .mdtTab.dragging{
      opacity: .85;
      transform: translateY(-4px) scale(1.04);
      box-shadow: 0 14px 30px rgba(0,0,0,.38), 0 0 30px var(--mdt-glow-strong, rgba(96,143,255,.22));
      cursor: var(--cur-move), grabbing;
    }
    .mdtTab.drag-over{
      border-left: 2px solid var(--mdt-border-strong, rgba(96,143,255,.9));
      box-shadow: inset 0 0 0 1px var(--mdt-border-strong, rgba(96,143,255,.9));
    }
    .mdtTabLabel{
      pointer-events: none;
    }

    /* Dashboard grid */
    .mdtDashGrid{
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 14px;
      margin-bottom: 18px;
    }
    .mdtDashRecent .mdtP{ color: var(--mdt-accent-text, rgba(215,230,255,.70)); }
    .mdtStat{
      border: 1px solid rgba(96,143,255,.22);
      background: rgba(0,0,0,.28);
      padding: 16px 14px;
      text-align: center;
    }
    .mdtStatNum{
      font-size: 28px;
      font-weight: 900;
      color: rgba(96,143,255,.95);
      letter-spacing: 1px;
    }
    .mdtStatLabel{
      font-size: 11px;
      letter-spacing: 1.4px;
      color: rgba(215,230,255,.55);
      margin-top: 6px;
    }
.mdtStat.mdtStatWarn .mdtStatNum{ color: rgba(255,200,64,.92); }
.mdtStat.mdtStatAlert .mdtStatNum{ color: rgba(255,80,80,.92); }
.mdtStat.mdtStatInfo .mdtStatNum{ color: var(--mdt-accent-1, rgba(96,143,255,.85)); }


    /* Search page */
    .mdtFilters{
      display: flex;
      gap: 8px;
      margin: 0 0 10px;
      flex-wrap: wrap;
    }
    .mdtFilterBtn{
      padding: 6px 10px;
      border: 1px solid var(--mdt-border, rgba(96,143,255,.28));
      background: rgba(0,0,0,.26);
      color: var(--mdt-accent-text, rgba(215,230,255,.78));
      cursor: var(--cur-link), pointer;
      font-weight: 700;
      letter-spacing: 1px;
      text-transform: uppercase;
      transition: border-color .12s ease, color .12s ease, background .12s ease, box-shadow .12s ease;
    }

    /* Smaller filter buttons (used on Arrests page controls) */
    .mdtFilterBtn.mdtFilterBtn--sm{
      padding: 4px 8px;
      font-size: 11px;
      letter-spacing: .8px;
    }
    .mdtFilterBtn.on{
      border-color: var(--mdt-border-strong, rgba(96,143,255,.85));
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,.35));
      color: var(--mdt-accent-strong-text, rgba(230,245,245,.98));
      box-shadow: 0 0 18px var(--mdt-glow-strong, rgba(96,143,255,.22));
    }

.mdtSearchBar{
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 10px;
      margin-bottom: 14px;
      align-items: center;
    }

    .mdtInput{
      width: 100%;
      background: rgba(0,0,0,.38);
      border: 1px solid var(--mdt-border, rgba(96,143,255,.28));
      color: var(--mdt-accent-strong-text, rgba(215,230,255,.92));
      padding: 10px 14px;
      font-size: 14px;
      letter-spacing: .6px;
      outline: none;
    }

    .mdtInput{
      flex: 1;
      background: rgba(0,0,0,.38);
      border: 1px solid rgba(96,143,255,.28);
      color: rgba(215,230,255,.92);
      padding: 10px 14px;
      font-size: 14px;
      letter-spacing: .6px;
      outline: none;
    }
    .mdtInput:focus{
      border-color: rgba(96,143,255,.65);
      box-shadow: 0 0 8px rgba(96,143,255,.18);
    }
    .mdtInput::placeholder{
      color: rgba(215,230,255,.35);
    }
    .mdtBtn{
      background: rgba(96,143,255,.18);
      border: 1px solid rgba(96,143,255,.45);
      color: rgba(96,143,255,.95);
      padding: 10px 20px;
      font-weight: 700;
      letter-spacing: 1.2px;
      cursor: var(--cur-link), pointer;
      transition: background .12s, border-color .12s;
    }
    .mdtBtn:hover{
      background: rgba(96,143,255,.32);
      border-color: rgba(96,143,255,.72);
    }

    .mdtBtn:disabled{
      opacity: .45;
      cursor: var(--cur-unavail), not-allowed;
      filter: grayscale(.25);
    }

    /* Yellow-tinted button variant (used for HIDE/SHOW toggles). */
    .mdtBtn.mdtBtnY{
      background: rgba(var(--ylRGB), .18);
      border-color: rgba(var(--ylRGB), .45);
      color: rgba(var(--ylRGB), .95);
    }
    .mdtBtn.mdtBtnY:hover{
      background: rgba(var(--ylRGB), .32);
      border-color: rgba(var(--ylRGB), .72);
    }

    .mdtRange{
      -webkit-appearance: none;
      appearance: none;
      height: 18px;
      background: transparent;
      accent-color: rgba(96,143,255,.85);
    }
    .mdtRange::-webkit-slider-runnable-track{
      height: 6px;
      border-radius: 999px;
      background: linear-gradient(90deg, rgba(96,143,255,.55), rgba(96,143,255,.18));
      border: 1px solid rgba(96,143,255,.20);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.4);
    }
    .mdtRange::-webkit-slider-thumb{
      -webkit-appearance: none;
      appearance: none;
      width: 14px;
      height: 14px;
      border-radius: 50%;
      margin-top: -5px;
      background: radial-gradient(circle at 35% 35%, rgba(255,255,255,.85), rgba(96,143,255,.85));
      border: 1px solid rgba(96,143,255,.85);
      box-shadow: 0 0 0 1px rgba(0,0,0,.65) inset, 0 0 10px rgba(96,143,255,.25);
    }
    .mdtRange::-moz-range-track{
      height: 6px;
      border-radius: 999px;
      background: linear-gradient(90deg, rgba(96,143,255,.55), rgba(96,143,255,.18));
      border: 1px solid rgba(96,143,255,.20);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.4);
    }
    .mdtRange::-moz-range-thumb{
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: radial-gradient(circle at 35% 35%, rgba(255,255,255,.85), rgba(96,143,255,.85));
      border: 1px solid rgba(96,143,255,.85);
      box-shadow: 0 0 0 1px rgba(0,0,0,.65) inset, 0 0 10px rgba(96,143,255,.25);
    }
    .mdtRange:disabled::-webkit-slider-runnable-track,
    .mdtRange:disabled::-moz-range-track{
      background: rgba(96,143,255,.10);
      border-color: rgba(96,143,255,.12);
    }
    .mdtRange:disabled::-webkit-slider-thumb,
    .mdtRange:disabled::-moz-range-thumb{
      opacity: .45;
      box-shadow: none;
    }

    .mdtCreateBar{
      display: flex;
      justify-content: flex-end;
      margin: 8px 0 0;
    }

    .mdtCreateBtn{
      min-width: 86px;
    }

    .mdtCreateBtn--primary{
      background: rgba(96,143,255,.28);
      border-color: rgba(96,143,255,.78);
      color: rgba(225,238,255,.98);
      box-shadow: 0 0 12px rgba(96,143,255,.18);
      min-width: 160px;
    }

    .mdtCreateBtn--primary:hover{
      background: rgba(96,143,255,.38);
      border-color: rgba(96,143,255,.95);
    }

    /* Create forms */
    .mdtCreate .mdtFormGrid{
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
      margin: 12px 0;
    }

    .mdtCreate .mdtFormRow{
      display: grid;
      gap: 6px;
    }

    .mdtCreate .mdtFormRow .k{
      font-size: 11px;
      letter-spacing: 1.6px;
      text-transform: uppercase;
      color: var(--mdt-accent-text, rgba(215,230,255,.70));
    }

    .mdtCreate .mdtFormRow textarea{
      min-height: 90px;
      resize: vertical;
    }

    .mdtCreate .mdtFormRowFull{
      grid-column: 1 / -1;
    }

    .mdtCreate .mdtFormActions{
       display: flex;
       justify-content: flex-end;
       gap: 10px;
     }

     /* Picker / chips */
     .mdtPicker{
       position: relative;
       display: grid;
       gap: 8px;
     }

      .mdtPickerRow{
        display: flex;
        gap: 10px;
        align-items: center;
      }
      .mdtPickerRow > [data-picker-input]{
        flex: 1 1 auto;
        min-width: 0;
      }
      .mdtPickerRow > button,
      .mdtPickerRow > .mdtBtn{
        flex: 0 0 auto;
      }


     .mdtPickerResults{
       position: absolute;
       left: 0;
       right: 0;
       top: calc(100% + 2px);
       background: rgba(0,0,0,.92);
       border: 1px solid var(--mdt-border, rgba(96,143,255,.30));
       box-shadow: 0 12px 26px rgba(0,0,0,.55);
       z-index: 5;
       max-height: 180px;
       overflow: auto;
     }

     .mdtPickerItem{
       padding: 10px 12px;
       cursor: var(--cur-link), pointer;
       color: rgba(215,230,255,.85);
       border-bottom: 1px solid rgba(96,143,255,.12);
     }

     .mdtPickerItem:hover{
       background: rgba(96,143,255,.18);
     }

     .mdtChips{
       display: flex;
       flex-wrap: wrap;
       gap: 8px;
     }

     .mdtChip{
       display: inline-flex;
       align-items: center;
       gap: 8px;
       padding: 6px 10px;
       border: 1px solid rgba(96,143,255,.28);
       background: rgba(0,0,0,.28);
       color: rgba(215,230,255,.82);
       font-size: 12px;
       letter-spacing: .5px;
     }

     .mdtChipX{
       width: 18px;
       height: 18px;
       border: 1px solid rgba(96,143,255,.25);
       background: rgba(0,0,0,.22);
       color: rgba(215,230,255,.78);
       cursor: var(--cur-link), pointer;
       line-height: 1;
       padding: 0;
       font-weight: 900;
     }

     .mdtChipX:hover{
       border-color: rgba(96,143,255,.60);
       color: rgba(96,143,255,.98);
     }


    /* Notes editor */
.mdtDetailNotesHead{
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }
    .mdtDetailNotesActions{ display:flex; gap:8px; flex-wrap:wrap; }


    .mdtDetailNotesActions{
      display: flex;
      gap: 8px;
    }

    .mdtNotesArea{
      min-height: 110px;
      margin-top: 10px;
      resize: vertical;
    }

    /* Results list */
    .mdtResults{
      max-height: 520px;
      overflow-y: auto;
      scrollbar-color: var(--mdt-scrollbar, rgba(96,143,255,.35)) rgba(0,0,0,.28);
      display: grid;
      gap: 8px;
    }

     .mdtCardGrid{
       display:grid;
       grid-template-columns: repeat(3, minmax(0, 1fr));
       gap: 10px;
     }

     /* Organizations search: compact glyph cards (like citizen profiles, smaller) */
     .mdtOrgSections{ display:grid; gap: 12px; }

     .mdtOrgSection{
       border: 1px solid var(--mdt-border, rgba(96,143,255,.14));
       background: rgba(0,0,0,.10);
       box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset;
       padding: 10px;
     }

     .mdtOrgSectionHead{
       display:flex;
       align-items:center;
       justify-content:space-between;
       padding: 0 2px 10px;
       font-weight: 900;
       letter-spacing: 2px;
       text-transform: uppercase;
       font-size: 12px;
       opacity: .92;
     }

     .mdtOrgSectionCount{
       margin-left: 10px;
       padding: 2px 8px;
       border-radius: 999px;
       border: 1px solid rgba(255,255,255,.12);
       background: rgba(0,0,0,.22);
       font-size: 11px;
       letter-spacing: 1px;
       opacity: .9;
     }

     .mdtOrgSection--government{ border-color: rgba(80, 255, 190, .18); }
     .mdtOrgSection--government .mdtOrgSectionHead{ color: rgba(120, 255, 210, .92); }

     .mdtOrgSection--corporation{ border-color: rgba(255, 210, 90, .18); }
     .mdtOrgSection--corporation .mdtOrgSectionHead{ color: rgba(255, 232, 170, .92); }

     .mdtOrgSection--small_business{ border-color: rgba(140, 170, 255, .20); }
     .mdtOrgSection--small_business .mdtOrgSectionHead{ color: rgba(190, 210, 255, .92); }

     .mdtOrgGrid{ grid-template-columns: repeat(4, minmax(0, 1fr)); }

     .mdtCard.mdtOrgCard{
       display:flex;
       gap: 10px;
       align-items:center;
       padding: 10px;
       border: 1px solid var(--mdt-border, rgba(96,143,255,.18));
       background: rgba(0,0,0,.18);
       box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset;
       cursor: var(--cur-link), pointer;
       transition: border-color .12s ease, box-shadow .12s ease, transform .12s ease;
     }

     .mdtCard.mdtOrgCard[data-org-kind="government"]{ border-color: rgba(80, 255, 190, .30); }
     .mdtCard.mdtOrgCard[data-org-kind="corporation"]{ border-color: rgba(255, 210, 90, .28); }
     .mdtCard.mdtOrgCard[data-org-kind="small_business"]{ border-color: rgba(140, 170, 255, .28); }

     .mdtCard.mdtOrgCard:hover{
       transform: translateY(-1px);
       border-color: var(--mdt-border-strong, rgba(96,143,255,.55));
       box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset, 0 0 18px var(--mdt-glow-strong, rgba(96,143,255,.12));
     }

     .mdtOrgGlyph{
       width: 44px;
       height: 44px;
       border-radius: 10px;
       border: 1px solid var(--mdt-border, rgba(96,143,255,.22));
       background: rgba(0,0,0,.22);
       display:flex;
       align-items:center;
       justify-content:center;
       overflow:hidden;
       flex: 0 0 auto;
     }

     .mdtOrgGlyphImg{ width: 100%; height: 100%; object-fit: cover; }

     .mdtOrgGlyphFallback{
       font-weight: 900;
       letter-spacing: 1.4px;
       color: rgba(255, 232, 170, .92);
       text-shadow: 0 0 14px rgba(255, 200, 80, .10);
       font-size: 13px;
       text-transform: uppercase;
     }

      .mdtOrgText{ min-width: 0; }
      .mdtOrgText .mdtCardTitle{ font-size: 14px; line-height: 1.1; }
      .mdtOrgType{
        margin-top: 2px;
        font-size: 12px;
        font-weight: 900;
        letter-spacing: .8px;
        text-transform: uppercase;
        color: rgba(255, 232, 170, .95);
        text-shadow: 0 0 14px rgba(255, 200, 80, .12);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .mdtCard.mdtOrgCard[data-org-kind="government"] .mdtOrgType{ color: rgba(120, 255, 210, .95); text-shadow: 0 0 14px rgba(80, 255, 190, .10); }
      .mdtCard.mdtOrgCard[data-org-kind="small_business"] .mdtOrgType{ color: rgba(190, 210, 255, .95); text-shadow: 0 0 14px rgba(120, 170, 255, .10); }
      .mdtOrgText .mdtMeta{ white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .mdtVehicleGrid{
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    }

    .mdtMedicalGrid{
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    }

    .mdtWeaponGrid{
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    }

    .mdtHeroCard{
      border: 1px solid var(--mdt-border, rgba(96,143,255,.18));
      background: rgba(0,0,0,.22);
      box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset;
      overflow: hidden;
      position: relative;
      display: grid;
      grid-template-rows: 1fr auto;
      min-height: 210px;
    }

    .mdtHeroMedia{
      position: relative;
      min-height: 170px;
      background:
        radial-gradient(900px 420px at 20% 0%, rgba(96,143,255,.14), rgba(0,0,0,0) 60%),
        linear-gradient(145deg, rgba(255,255,255,.06), rgba(0,0,0,.65));
      background-size: cover;
      background-position: center;
    }

    .mdtHeroMedia--placeholder{
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.55);
    }

    .mdtHeroMedia--placeholder::before{
      content: '';
      position: absolute;
      inset: 0;
      opacity: .9;
      background:
        radial-gradient(520px 260px at 22% 18%, var(--mdt-accent-fade-1, rgba(96,143,255,.10)), rgba(0,0,0,0) 62%),
        linear-gradient(135deg, rgba(255,255,255,.06), rgba(0,0,0,.68));
    }

    .mdtHeroMedia--placeholder::after{
      position: absolute;
      left: 12px;
      top: 10px;
      padding: 6px 10px;
      border: 1px solid var(--mdt-border, rgba(96,143,255,.25));
      background: rgba(0,0,0,.55);
      color: var(--mdt-accent-text, rgba(215,230,255,.75));
      letter-spacing: 1.6px;
      text-transform: uppercase;
      font-size: 11px;
    }

    .mdtHeroMedia--vehicle::after{ content: 'VEHICLE'; }
    .mdtHeroMedia--person::after{ content: 'PROFILE'; }
    .mdtHeroMedia--weapon::after{ content: 'WEAPON'; }

    .mdtHeroOverlay{
      position: absolute;
      inset: 0;
      display: grid;
      gap: 10px;
      padding: 12px;
      align-content: end;
      background:
        linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,.30) 40%, rgba(0,0,0,.76) 100%);
    }

    .mdtHeroTitle{
      font-weight: 900;
      letter-spacing: 1.4px;
      color: rgba(240,248,255,.96);
      text-transform: uppercase;
      text-shadow: 0 2px 12px rgba(0,0,0,.8);
    }

    .mdtHeroTop{
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }

    .mdtHeroBadges{
      display: inline-flex;
      gap: 6px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .mdtHeroMeta{
      display: grid;
      gap: 4px;
      color: rgba(215,230,255,.80);
      font-size: 12px;
      letter-spacing: .5px;
      text-shadow: 0 2px 12px rgba(0,0,0,.8);
    }

    .mdtHeroLine{
      display: inline-block;
    }

    .mdtHeroLine .mdtLinkish{
      text-decoration: underline;
      text-underline-offset: 2px;
    }

    .mdtHeroActions{
      display: flex;
      gap: 8px;
      padding: 10px 12px;
      border-top: 1px solid var(--mdt-border, rgba(96,143,255,.18));
      background: rgba(0,0,0,.26);
      align-items: center;
      justify-content: flex-start;
      flex-wrap: wrap;
    }

    .mdtOrgHead{
      display: flex;
      gap: 12px;
      align-items: center;
      flex: 1 1 320px;
      min-width: 260px;
    }

    .mdtDetailHead.mdtOrgDetailHead{
      align-items: flex-start;
    }

    .mdtOrgLogo{
      width: 74px;
      height: 74px;
      border: 1px solid var(--mdt-border, rgba(96,143,255,.18));
      box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset;
      background: rgba(0,0,0,.25);
      overflow: hidden;
      display: grid;
      place-items: center;
    }

    .mdtOrgLogoImg{
      width: 100%;
      height: 100%;
      object-fit: cover;
      filter: saturate(1.1) contrast(1.05);
    }

    .mdtOrgLogoFallback{
      font-weight: 900;
      letter-spacing: 1px;
      color: var(--mdt-accent-strong-text, rgba(96,143,255,.95));
    }

    .mdtOrgHeadText{ display: grid; gap: 4px; }

    .mdtCard{
      border: 1px solid var(--mdt-border, rgba(96,143,255,.18));
      background: rgba(0,0,0,.22);
      box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset;
      padding: 12px;
      display: grid;
      gap: 8px;
      position: relative;
    }
    .mdtCardHead{ display: flex; align-items: center; gap: 10px; }
    .mdtCardHeadText{ display: grid; gap: 6px; }
    .mdtCardImg{
      width: 56px;
      height: 56px;
      background: rgba(255,255,255,.04);
      border: 1px solid var(--mdt-border, rgba(96,143,255,.22));
      box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset;
      display: grid;
      place-items: center;
      font-size: 22px;
      color: var(--mdt-accent-text, rgba(215,230,255,.78));
    }

    /* Citizen cards */
    .mdtCitizenCard{
      display: grid;
      gap: 10px;
      cursor: var(--cur-link), pointer;
    }

    .mdtCitizenCard:focus{
      outline: none;
      border-color: var(--mdt-border-strong, rgba(96,143,255,.65));
      box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset, 0 0 20px var(--mdt-glow-strong, rgba(96,143,255,.14));
    }

    /* New Citizen card layout: name above big photo */
    .mdtCitizenCard--photo{
      gap: 10px;
    }

    /* WARRANT visuals: red outline + red title */
    .mdtCitizenCard--warrant{
      border-color: rgba(255, 60, 60, .55);
      box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset, 0 0 22px rgba(255, 60, 60, .10);
    }

    .mdtCitizenCard--warrant .mdtCitizenBigPhoto{
      border-color: rgba(255, 60, 60, .35);
    }

    .mdtCitizenCard--warrant .mdtCardTitle{
      color: rgba(255, 140, 140, .95);
      text-shadow: 0 0 18px rgba(255, 60, 60, .18);
    }

    .mdtCitizenCard--warrant .mdtCitizenIdNum{
      color: rgba(255, 120, 120, .95);
    }

    .mdtCitizenCardTop{
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 10px;
    }

    .mdtCitizenBigPhoto{
      position: relative;
      width: 100%;
      height: 220px;
      border: 1px solid var(--mdt-border, rgba(96,143,255,.18));
      box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset;
      background: rgba(0,0,0,.25);
      overflow: hidden;
    }

    .mdtCitizenBigPhoto img{
      width: 100%;
      height: 100%;
      object-fit: cover;
      filter: saturate(1.05) contrast(1.05);
      transform: scale(1.02);
    }

    .mdtCitizenCardOverlay{
      position: absolute;
      inset: 0;
      pointer-events: none;
      display: grid;
      grid-template-rows: auto 1fr auto;
      padding: 10px;
      background:
        linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,0) 55%, rgba(0,0,0,.62));
      z-index: 2;
    }

    /* Large alert stripe across the photo (BOLO / WARRANT) */
    .mdtCitizenAlertStripe{
      position: absolute;
      left: -22%;
      right: -22%;
      top: 50%;
      transform: translateY(-50%) rotate(-12deg);
      height: 54px;
      display: grid;
      place-items: center;
      z-index: 1;
      border-top: 1px solid rgba(0,0,0,.55);
      border-bottom: 1px solid rgba(0,0,0,.55);
      box-shadow: 0 10px 24px rgba(0,0,0,.35);
      pointer-events: none;
      opacity: .98;

      background:
        repeating-linear-gradient(
          90deg,
          rgba(255,255,255,.22) 0,
          rgba(255,255,255,.22) 10px,
          rgba(255,255,255,.10) 10px,
          rgba(255,255,255,.10) 20px
        );
    }

    /* When both warrant + bolo exist, show two stripes (stacked). */
    .mdtCitizenAlertStripe--solo{ top: 50%; }
    .mdtCitizenAlertStripe--primary{ top: 38%; }
    .mdtCitizenAlertStripe--secondary{ top: 62%; }

    .mdtCitizenAlertStripeText{
      font-size: 18px;
      font-weight: 1000;
      letter-spacing: 4px;
      text-transform: uppercase;
      color: rgba(255,255,255,.95);
      text-shadow: 0 2px 10px rgba(0,0,0,.55);
      mix-blend-mode: screen;
    }

    .mdtCitizenAlertStripe--warrant{
      background-color: rgba(255, 60, 60, .62);
      border-top-color: rgba(255, 60, 60, .85);
      border-bottom-color: rgba(255, 60, 60, .85);
    }

    .mdtCitizenAlertStripe--bolo{
      background-color: rgba(255, 180, 60, .55);
      border-top-color: rgba(255, 180, 60, .75);
      border-bottom-color: rgba(255, 180, 60, .75);
    }

    @media (max-width: 520px){
      .mdtCitizenAlertStripe{ height: 46px; }
      .mdtCitizenAlertStripeText{ font-size: 16px; letter-spacing: 3px; }
    }

    .mdtCitizenCardOverlayTop{
      display: flex;
      justify-content: flex-end;
    }

    .mdtCitizenCardOverlayBottom{
      display: flex;
      align-items: flex-end;
    }

    .mdtCitizenOverlayBadges{
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      align-items: flex-end;
    }

    .mdtCitizenCardMeta{
      display: flex;
      justify-content: space-between;
      gap: 10px;
      align-items: baseline;
      color: rgba(215,230,255,.68);
    }

    .mdtCitizenIdLine{
      font-size: 12px;
      font-weight: 800;
      letter-spacing: 1px;
      text-transform: uppercase;
      color: rgba(215,230,255,.72);
    }

    .mdtCitizenIdNum{
      color: rgba(96,143,255,.95);
    }

    /* Gov org logo strip (small icons) */
    .mdtCitizenGovLogoStrip{
      display: flex;
      gap: 6px;
      align-items: center;
      flex-wrap: wrap;
    }

    .mdtCitizenGovLogoBtn{
      appearance: none;
      border: 0;
      padding: 0;
      margin: 0;
      background: transparent;
      cursor: var(--cur-link), pointer;
      display: inline-flex;
      border-radius: 8px;
    }

    .mdtCitizenGovLogoBtn:focus{
      outline: none;
      box-shadow: 0 0 0 2px rgba(96,143,255,.45);
    }

    .mdtCitizenGovLogo{
      width: 26px;
      height: 26px;
      object-fit: cover;
      border-radius: 6px;
      border: 1px solid rgba(96,143,255,.25);
      box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset;
      background: rgba(0,0,0,.35);
    }

    .mdtCitizenGovLogoBtn:hover .mdtCitizenGovLogo{
      border-color: rgba(96,143,255,.55);
    }

    .mdtCitizenGovLogoStrip--card .mdtCitizenGovLogo{
      width: 28px;
      height: 28px;
    }

    .mdtCitizenGovLogoStrip--detail{
      margin: 8px 0 0;
    }

    /* Legacy citizen card layout bits (kept for compatibility) */
    .mdtCitizenHead{
      align-items: center;
      gap: 12px;
    }
    .mdtCitizenBody{
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 6px 10px;
    }
    .mdtAvatar{
      width: 64px;
      height: 64px;
      border-radius: 50%;
      overflow: hidden;
      border: 1px solid var(--mdt-border, rgba(96,143,255,.24));
      box-shadow: 0 0 0 1px rgba(0,0,0,.55) inset;
      background: radial-gradient(180% 120% at 16% 12%, rgba(96,143,255,.18), rgba(0,0,0,.55));
      flex-shrink: 0;
    }
    .mdtAvatar img{
      width: 100%;
      height: 100%;
      object-fit: cover;
      filter: saturate(1.05) contrast(1.05);
    }
    .mdtCardTitle{ color: var(--mdt-accent-strong-text, rgba(215,230,255,.95)); font-weight: 800; letter-spacing: .6px; }
    .mdtCardSub{ color: var(--mdt-accent-text, rgba(215,230,255,.72)); font-size: 12px; letter-spacing: .4px; }
    .mdtCardMeta{ color: var(--mdt-accent-text, rgba(215,230,255,.70)); font-size: 12px; display: grid; gap: 4px; }
    .mdtCardActions{ display: flex; gap: 8px; flex-wrap: wrap; }
    .mdtCardBtn{
      padding: 6px 10px;
      background: rgba(0,0,0,.24);
      border: 1px solid var(--mdt-border, rgba(96,143,255,.45));
      color: var(--mdt-accent-text, rgba(96,143,255,.95));
      cursor: var(--cur-link), pointer;
      font-weight: 700;
      letter-spacing: 1px;
      transition: border-color .12s ease, color .12s ease, background .12s ease;
    }
    .mdtCardBtn:hover{ border-color: var(--mdt-border-strong, rgba(96,143,255,.72)); color: var(--mdt-accent-strong-text, rgba(96,143,255,.98)); background: rgba(0,0,0,.32); }
    .mdtNoResults{
      color: rgba(215,230,255,.45);
      padding: 20px;
      text-align: center;
      letter-spacing: .8px;
    }
.mdtResultItem{
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 8px;
      padding: 10px 10px;
      border: 1px solid var(--mdt-border, rgba(96,143,255,.18));
      background: rgba(0,0,0,.20);
      margin: 6px 0;
      align-items: center;
    }
    .mdtResultPrimary{ color: var(--mdt-accent-strong-text, rgba(215,230,255,.92)); font-weight: 700; letter-spacing: .6px; }
    .mdtResultSecondary{ color: var(--mdt-accent-text, rgba(215,230,255,.62)); font-size: 12px; letter-spacing: .4px; }
    .mdtResultActions{ display: flex; gap: 6px; }
    .mdtResultView,
    .mdtCopy{
      padding: 6px 10px;
      background: rgba(0,0,0,.24);
      border: 1px solid var(--mdt-border, rgba(96,143,255,.45));
      color: var(--mdt-accent-text, rgba(96,143,255,.95));
      cursor: var(--cur-link), pointer;
      font-weight: 700;
      letter-spacing: 1px;
      transition: border-color .12s ease, color .12s ease, background .12s ease;
    }
    .mdtResultView:hover,
    .mdtCopy:hover{
      border-color: var(--mdt-border-strong, rgba(96,143,255,.72));
      color: var(--mdt-accent-strong-text, rgba(96,143,255,.98));
      background: rgba(0,0,0,.32);
    }
    .mdtCopy.copied{ color: var(--mdt-accent-1, rgba(96,143,255,.90)); border-color: var(--mdt-border-strong, rgba(96,143,255,.85)); }

    .mdtResultItem:hover{
      background: rgba(96,143,255,.08);
    }
    .mdtResultPrimary{
      font-weight: 700;
      color: rgba(215,230,255,.88);
      letter-spacing: .6px;
    }
    .mdtResultSecondary{
      grid-column: 1;
      font-size: 12px;
      color: rgba(215,230,255,.52);
      letter-spacing: .4px;
    }
    .mdtResultView{
      grid-row: 1 / 3;
      grid-column: 2;
      align-self: center;
      background: rgba(96,143,255,.12);
      border: 1px solid rgba(96,143,255,.35);
      color: rgba(96,143,255,.88);
      padding: 6px 14px;
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 1px;
      cursor: var(--cur-link), pointer;
      transition: background .1s, border-color .1s;
    }
    .mdtResultView:hover{
      background: rgba(96,143,255,.25);
      border-color: rgba(96,143,255,.65);
    }

    /* List items (dashboard) */
    .mdtList{}
    .mdtListItem{
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid rgba(96,143,255,.10);
    }
    .mdtListPrimary{
      color: rgba(215,230,255,.82);
      font-weight: 600;
      letter-spacing: .5px;
    }
    .mdtListSecondary{
      color: rgba(215,230,255,.48);
      font-size: 12px;
    }

    /* Modal */
    .mdtModal{
      position: fixed;
      inset: 0;
      z-index: 9998;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .mdtModalBackdrop{
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,.72);
    }
    .mdtModalContent{
      position: relative;
      width: 90%;
      max-width: 560px;
      max-height: 80vh;
      background: linear-gradient(180deg, rgba(12,18,32,.98), rgba(6,10,22,.98));
      border: 1px solid rgba(96,143,255,.35);
      box-shadow: 0 0 40px rgba(96,143,255,.18), 0 0 0 1px rgba(0,0,0,.82) inset;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    .mdtModalHead{
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 18px;
      border-bottom: 1px solid rgba(96,143,255,.22);
      background: rgba(0,0,0,.28);
    }
    .mdtModalTitle{
      font-weight: 800;
      letter-spacing: 1.4px;
      text-transform: uppercase;
      color: rgba(96,143,255,.95);
    }
    .mdtModalClose{
      background: transparent;
      border: 1px solid rgba(96,143,255,.28);
      color: rgba(215,230,255,.65);
      width: 28px;
      height: 28px;
      cursor: var(--cur-link), pointer;
      font-weight: 900;
      transition: border-color .1s, color .1s;
    }
    .mdtModalClose:hover{
      border-color: rgba(255,80,80,.65);
      color: rgba(255,80,80,.95);
    }
    .mdtModalBody{
      padding: 18px;
      overflow-y: auto;
      flex: 1;
      scrollbar-color: rgba(96,143,255,.35) rgba(0,0,0,.28);
    }
    .mdtModalRow{
      display: grid;
      grid-template-columns: 140px 1fr;
      gap: 8px;
      padding: 8px 0;
      border-bottom: 1px solid rgba(96,143,255,.08);
    }
    .mdtModalKey{
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 1px;
      color: rgba(96,143,255,.72);
    }
    .mdtModalVal{
      color: rgba(215,230,255,.82);
      letter-spacing: .4px;
      word-break: break-word;
    }

    /* Full Detail Pages */
    .mdtDetail{
      padding: 0;
    }
    .mdtDetailHead{
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 12px 20px;
      padding: 20px;
      background: linear-gradient(180deg, rgba(96,143,255,.08), rgba(0,0,0,.18));
      border-bottom: 1px solid rgba(96,143,255,.18);
      margin-bottom: 20px;
    }
    .mdtCitizenHead{
      align-items: flex-start;
      gap: 16px 24px;
    }
    .mdtCitizenPortrait{
      display: grid;
      gap: 8px;
      width: 180px;
      max-width: 32vw;
    }
    .mdtCitizenPhoto{
      width: 100%;
      aspect-ratio: 1 / 1;
      border: 1px solid var(--mdt-border, rgba(96,143,255,.24));
      box-shadow: 0 0 0 1px rgba(0,0,0,.55) inset, 0 0 18px rgba(96,143,255,.16);
      overflow: hidden;
      background: radial-gradient(160% 140% at 18% 12%, rgba(96,143,255,.18), rgba(0,0,0,.72));
      position: relative;
    }
    .mdtCitizenPhoto::after{
      content:'';
      position:absolute;
      inset:0;
      border:1px solid rgba(255,255,255,.06);
      pointer-events:none;
      mix-blend-mode:screen;
    }
    .mdtCitizenPhoto{
      cursor: var(--cur-up), zoom-in;
    }
    .mdtCitizenPhoto img{
      width: 100%;
      height: 100%;
      object-fit: cover;
      filter: saturate(1.08) contrast(1.06);
    }

    .mdtCitizenAlertStripe{
      pointer-events: none;
    }

    .mdtBtn.mdtBtnIcon{
      width: 40px;
      padding: 0;
      display: inline-grid;
      place-items: center;
      font-weight: 900;
      letter-spacing: 0;
    }

    .mdtGalleryGrid{
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 12px;
    }

    .mdtGalleryItem{
      border: 1px solid var(--mdt-border, rgba(96,143,255,.20));
      background: rgba(0,0,0,.18);
      box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset;
      padding: 10px;
      display: grid;
      gap: 10px;
    }

    .mdtGalleryThumb{
      width: 100%;
      aspect-ratio: 1 / 1;
      object-fit: cover;
      border: 1px solid var(--mdt-border, rgba(96,143,255,.20));
      cursor: var(--cur-up), zoom-in;
      filter: saturate(1.06) contrast(1.04);
    }

    .mdtGalleryActions{
      display:flex;
      justify-content:flex-end;
      gap: 8px;
    }

    /* Citizen detail WARRANT theme */
    .mdtCitizenDetail--warrant .mdtDetailHead{
      border-bottom-color: rgba(255, 60, 60, .28);
      background: linear-gradient(180deg, rgba(255,60,60,.10), rgba(0,0,0,.18));
    }

    .mdtCitizenDetail--warrant .mdtDetailTitle{
      color: rgba(255, 140, 140, .95);
      text-shadow: 0 0 18px rgba(255, 60, 60, .18);
    }

    .mdtCitizenDetail--warrant .mdtDetailSubtitle,
    .mdtCitizenDetail--warrant .mdtMeta,
    .mdtCitizenDetail--warrant .mdtPronouns{
      color: rgba(255, 165, 165, .70);
    }

    .mdtCitizenDetail--warrant .mdtDetailSectionTitle{
      color: rgba(255, 165, 165, .80);
      border-bottom-color: rgba(255, 60, 60, .18);
    }

    .mdtCitizenDetail--warrant .mdtDetailRow{
      border-bottom-color: rgba(255, 60, 60, .08);
    }

    .mdtCitizenDetail--warrant .mdtDetailKey{
      color: rgba(255, 165, 165, .55);
    }

    .mdtCitizenDetail--warrant .mdtDetailVal{
      color: rgba(255, 165, 165, .92);
    }

    .mdtCitizenDetail--warrant .mdtDetailSection{
      border-color: rgba(255, 60, 60, .22);
      box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset, 0 0 20px rgba(255, 60, 60, .06);
    }

    /* Detail variant of the diagonal stripe (bigger and centered to portrait). */
    .mdtCitizenAlertStripe--detail{
      left: -30%;
      right: -30%;
      height: 62px;
      transform: translateY(-50%) rotate(-14deg);
      z-index: 2;
    }

    .mdtCitizenAlertStripe--detail .mdtCitizenAlertStripeText{
      font-size: 18px;
      letter-spacing: 5px;
    }

    .mdtPhotoActions{
      display: flex;
      gap: 8px;
    }
    .mdtCitizenMeta{ flex: 1 1 320px; display: grid; gap: 6px; }
    .mdtCitizenBadges{ display: flex; flex-wrap: wrap; gap: 8px; }
    .mdtPronouns{ color: rgba(215,230,255,.70); letter-spacing: .8px; font-size: 12px; }

    /* Header notes box on the right (citizens + organizations) */
    .mdtCitizenTopNotes,
    .mdtOrgTopNotes{
      flex: 1 1 360px;
      min-width: 260px;
      max-width: 520px;
      align-self: stretch;
      display: flex;
    }
    .mdtCitizenTopNotes .mdtDetailNotes,
    .mdtOrgTopNotes .mdtDetailNotes{
      margin: 0;
      width: 100%;
      padding: 10px;
    }
    .mdtCitizenTopNotes .mdtDetailNotesHead,
    .mdtOrgTopNotes .mdtDetailNotesHead{ gap: 8px; }
    .mdtCitizenTopNotes .mdtDetailNotesActions,
    .mdtOrgTopNotes .mdtDetailNotesActions{ gap: 6px; }

    /* Keep header notes compact: hide formatting toolbar */
    .mdtCitizenTopNotes .mdtRichbar,
    .mdtOrgTopNotes .mdtRichbar{ display: none !important; }

    .mdtCitizenTopNotes .mdtRichEditor,
    .mdtOrgTopNotes .mdtRichEditor{
      min-height: 90px !important;
      max-height: 160px;
      overflow: auto;
    }

    /* Collapsible panels */
    .mdtPanel.mdtCollapsible{
      padding: 8px 12px;
    }
    .mdtPanel.mdtCollapsible .mdtH{
      user-select: none;
      margin: 0;
      padding: 0;
      border: 0;
      line-height: 1.1;
    }
    .mdtPanel.mdtCollapsible .mdtCollapsibleBody{ margin-top: 10px; }
    .mdtPanel.mdtCollapsible[data-collapsed="1"] .mdtCollapsibleBody{ display:none; }
    .mdtPanel.mdtCollapsible[data-collapsed="1"]{
      padding-top: 6px;
      padding-bottom: 6px;
    }

    .mdtDetailSubhead{ font-size: 11px; letter-spacing: 1px; font-weight: 800; color: rgba(96,143,255,.75); margin: 10px 0 6px; }
    .mdtDetailTitle{
      font-size: 22px;
      font-weight: 900;
      letter-spacing: 2px;
      text-transform: uppercase;
      color: rgba(96,143,255,.95);
      flex: 1 1 100%;
    }

    .mdtBanner{
      padding: 10px 14px;
      border: 1px solid var(--mdt-border, rgba(96,143,255,.25));
      background: rgba(0,0,0,.22);
      color: rgba(215,230,255,.88);
      letter-spacing: 1px;
      font-weight: 800;
      text-transform: uppercase;
      margin: 10px 12px 0;
      box-shadow: 0 0 0 1px rgba(0,0,0,.55) inset;
    }
    .mdtBannerAlert{ border-color: rgba(255,60,60,.55); background: rgba(255,60,60,.08); color: rgba(255,120,120,.96); box-shadow: 0 0 12px rgba(255,60,60,.12); }
    .mdtBannerWarn{ border-color: rgba(255,180,60,.45); background: rgba(255,180,60,.06); color: rgba(255,210,130,.92); box-shadow: 0 0 12px rgba(255,180,60,.10); }
    .mdtDetailSubtitle{
      font-size: 13px;
      letter-spacing: 1.2px;
      color: rgba(215,230,255,.55);
      flex: 1 1 auto;
    }
    .mdtDetailBadge{
      display: inline-block;
      padding: 5px 12px;
      font-size: 11px;
      font-weight: 800;
      letter-spacing: 1px;
      text-transform: uppercase;
      border: 1px solid;
    }

    .mdtBadge{
      display: inline-block;
      padding: 5px 12px;
      font-size: 11px;
      font-weight: 800;
      letter-spacing: 1px;
      text-transform: uppercase;
      border: 1px solid;
      background: rgba(0,0,0,.18);
      color: rgba(215,230,255,.82);
    }
    .mdtBadgeAlert{
      background: rgba(255,60,60,.15);
      border-color: rgba(255,60,60,.55);
      color: rgba(255,100,100,.95);
    }
    .mdtBadgeWarn{
      background: rgba(255,180,60,.12);
      border-color: rgba(255,180,60,.45);
      color: rgba(255,200,100,.92);
    }
    .mdtBadgeOk{
      background: rgba(60,255,120,.10);
      border-color: rgba(60,255,120,.40);
      color: rgba(100,255,150,.90);
    }
    .mdtBadgeInfo{
      background: rgba(96,143,255,.12);
      border-color: rgba(96,143,255,.40);
      color: rgba(140,180,255,.90);
    }
    .mdtDetailGrid{
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      padding: 0 20px;
    }
    .mdtCitizenGrid{
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      align-items: start;
    }
    .mdtDetailSection{
      border: 1px solid rgba(96,143,255,.14);
      background: rgba(0,0,0,.18);
      padding: 16px;
    }
    .mdtSectionAlert{
      border-color: rgba(255,60,60,.35);
      background: rgba(255,60,60,.06);
    }
    .mdtSectionWarn{
      border-color: rgba(255,180,60,.30);
      background: rgba(255,180,60,.05);
    }
    .mdtDetailSectionTitle{
      font-size: 11px;
      font-weight: 800;
      letter-spacing: 1.4px;
      color: rgba(96,143,255,.75);
      margin-bottom: 12px;
      padding-bottom: 8px;
      border-bottom: 1px solid rgba(96,143,255,.12);
    }
    .mdtDetailRow{
      display: flex;
      justify-content: space-between;
      gap: 12px;
      padding: 8px 0;
      border-bottom: 1px solid rgba(96,143,255,.06);
    }
    .mdtDetailRow:last-child{
      border-bottom: none;
    }
    .mdtDetailKey{
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 1px;
      color: rgba(215,230,255,.48);
      flex-shrink: 0;
    }
    .mdtDetailVal{
      color: rgba(215,230,255,.88);
      text-align: right;
      word-break: break-word;
    }

    .mdtCopyText{
      cursor: var(--cur-link), pointer;
      text-decoration: underline;
      text-decoration-color: rgba(96,143,255,.55);
      text-underline-offset: 2px;
    }

    .mdtCopyText:hover{
      color: rgba(96,143,255,.95);
      text-decoration-color: rgba(96,143,255,.85);
    }

    .mdtToast{
      position: fixed;
      left: 50%;
      bottom: 22px;
      transform: translateX(-50%) translateY(10px);
      padding: 10px 14px;
      background: rgba(0,0,0,.78);
      border: 1px solid rgba(96,143,255,.35);
      box-shadow: 0 0 16px rgba(96,143,255,.12), 0 0 0 1px rgba(0,0,0,.75) inset;
      color: rgba(215,230,255,.92);
      font-weight: 800;
      letter-spacing: 1px;
      text-transform: uppercase;
      opacity: 0;
      pointer-events: none;
      z-index: 9999;
      transition: opacity .12s ease, transform .12s ease;
    }

    .mdtToast.on{
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    .mdtValWarn{
      color: rgba(255,180,80,.95);
    }
    .mdtValAlert{
      color: rgba(255,80,80,.95);
    }
    .mdtValHighlight{
      color: rgba(96,200,255,.95);
      font-weight: 700;
    }
    .mdtDetailItem{
      padding: 8px 12px;
      margin-bottom: 6px;
      background: rgba(0,0,0,.22);
      border-left: 3px solid rgba(96,143,255,.35);
      color: rgba(215,230,255,.78);
      font-size: 13px;
    }
    .mdtItemNone{
      color: rgba(215,230,255,.40);
      font-style: italic;
      border-left-color: rgba(96,143,255,.15);
    }
    .mdtItemWarn{
      border-left-color: rgba(255,180,60,.65);
      background: rgba(255,180,60,.08);
    }
    .mdtItemAlert{
      border-left-color: rgba(255,60,60,.65);
      background: rgba(255,60,60,.08);
      color: rgba(255,140,140,.92);
    }
    .mdtDetailNotes{
      margin: 20px;
      padding: 16px;
      border: 1px solid rgba(96,143,255,.12);
      background: rgba(0,0,0,.15);
    }
    .mdtDetailNotesText{
      color: rgba(215,230,255,.72);
      line-height: 1.6;
      letter-spacing: .4px;
    }
    .mdtDetailNotes .mdtInput{ min-height: 120px; }

    /* Lore view: Data Shards (Cyberpunk-style) */
    .lorestage{
      position: absolute;
      left: 0;
      right: 0;
      top: var(--topbar-h);
      bottom: 0;
      overflow: hidden;
      /* Keep below the global boot overlay (z-index:9999). */
      z-index: 90;
      background:
        radial-gradient(900px 520px at 26% 0%, rgba(96,143,255,.10), rgba(0,0,0,0) 62%),
        radial-gradient(820px 520px at 70% 0%, rgba(96,143,255,.06), rgba(0,0,0,0) 60%),
        linear-gradient(180deg, rgba(10,6,16,.82) 0%, rgba(1,6,27,.66) 42%, rgba(0,0,0,.92) 100%);
    }

    .shardDesk{
      position: absolute;
      inset: 12px 14px 14px;
      display: none;
      grid-template-columns: 230px 1fr;
      gap: 14px;
      border: 1px solid rgba(96,143,255,.14);
      background:
        radial-gradient(900px 520px at 22% 0%, rgba(96,143,255,.06), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,.28), rgba(0,0,0,.60));
      box-shadow:
        0 0 0 1px rgba(0,0,0,.72) inset,
        0 0 34px rgba(96,143,255,.06);
      overflow: hidden;
    }

    .shardDesk.on{ display: grid; }

    .shardTabs{
      position: relative;
      padding: 16px 14px;
      overflow: auto;
      scrollbar-color: rgba(255,220,64,.35) rgba(0,0,0,.30);
    }

    .shardTab{
      position: relative;
      width: 198px;
      max-width: 100%;
      height: 44px;
      margin: 10px auto;
      border: 1px solid rgba(96,143,255,.22);
      background:
        linear-gradient(180deg, rgba(0,0,0,.46), rgba(0,0,0,.22));
      cursor: var(--cur-link), pointer;
      box-shadow:
        0 0 0 1px rgba(0,0,0,.62) inset,
        0 0 22px rgba(96,143,255,.08);
      transition: transform .12s ease, border-color .12s ease, background .12s ease, opacity .12s ease, box-shadow .12s ease;

      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: 10px;

      padding: 0 14px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 11.5px;
      font-weight: 700;
      letter-spacing: 1.1px;
      text-transform: uppercase;
      color: rgba(215,230,255,.78);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;

      /* Square-ish like map UI elements */
      clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
    }

    .shardTab::after{
      content:"";
      position:absolute;
      inset: 4px;
      border: 1px solid rgba(96,143,255,.14);
      opacity: .9;
      pointer-events: none;
    }

    .shardTab:hover{
      border-color: rgba(96,143,255,.58);
      box-shadow:
        0 0 0 1px rgba(0,0,0,.62) inset,
        0 0 34px rgba(96,143,255,.18),
        0 0 76px rgba(96,143,255,.08);
    }

    .shardTab:hover::after{
      border-color: rgba(96,143,255,.28);
    }

    .shardTab.locked{
      opacity: .22;
      cursor: var(--cur-default), default;
      filter: grayscale(.2);
    }

    /* Unread: bright pulse */
    @keyframes shardPulse{
      0%, 100%{
        box-shadow:
          0 0 0 1px rgba(0,0,0,.62) inset,
          0 0 18px rgba(var(--ylRGB), .08);
      }
      55%{
        box-shadow:
          0 0 0 1px rgba(0,0,0,.62) inset,
          0 0 26px rgba(var(--ylRGB), .14),
          0 0 42px rgba(var(--ylRGB), .06);
      }
    }
    .shardTab.unread{
      border-color: rgba(var(--ylRGB), .34);
      color: rgba(var(--ylRGB), .86);
      text-shadow: 0 0 12px rgba(var(--ylRGB), .14);
      animation: shardPulse 1.15s ease-in-out infinite;
    }
    .shardTab.unread::after{ border-color: rgba(var(--ylRGB), .20); }

    /* Read: empty outline look */
    .shardTab.read{
      background: rgba(0,0,0,.16);
      border-color: rgba(96,143,255,.16);
      color: rgba(215,230,255,.48);
      text-shadow: none;
      box-shadow: 0 0 0 1px rgba(0,0,0,.62) inset;
    }
    .shardTab.read::after{ opacity: .55; }

    /* Active (currently open): filled yellow + glow */
    .shardTab.active{
      transform: translateX(4px);
      border-color: rgba(var(--ylRGB), .96);
      background:
        linear-gradient(180deg, rgba(var(--ylRGB), .92), rgba(var(--ylRGB), .78));
      color: rgba(0,0,0,.90);
      text-shadow: none;
      animation: none;
      box-shadow:
        0 0 0 1px rgba(0,0,0,.62) inset,
        0 0 34px rgba(var(--ylRGB), .26),
        0 0 92px rgba(var(--ylRGB), .14);
    }
    .shardTab.active::after{ opacity: .65; border-color: rgba(0,0,0,.42); }

    .shardTab.active:hover{
      box-shadow:
        0 0 0 1px rgba(0,0,0,.62) inset,
        0 0 42px rgba(var(--ylRGB), .30),
        0 0 120px rgba(var(--ylRGB), .16);
    }

    /* Active tab: invert shard icon to black */
    .shardTab.active .shardTabIcon{
      mix-blend-mode: normal;
      opacity: .98;
      filter: brightness(0) contrast(1.1);
    }

    /* Unlock effect: glitchy reveal */
    @keyframes shardUnlockFlicker{
      0%{ opacity: 0; transform: translateX(-6px) skewX(-8deg); filter: blur(.6px) saturate(1.2); }
      12%{ opacity: 1; transform: translateX(2px) skewX(10deg); }
      20%{ opacity: .35; transform: translateX(-2px) skewX(-12deg); }
      32%{ opacity: 1; transform: translateX(1px) skewX(6deg); }
      45%{ opacity: .55; transform: translateX(-1px) skewX(-6deg); }
      60%{ opacity: 1; transform: translateX(0) skewX(0); filter: none; }
      100%{ opacity: 1; transform: translateX(0) skewX(0); filter: none; }
    }

    @keyframes shardUnlockScan{
      0%{ transform: translateX(-120%) skewX(-18deg); opacity: 0; }
      25%{ opacity: .55; }
      55%{ opacity: .22; }
      100%{ transform: translateX(120%) skewX(-18deg); opacity: 0; }
    }

    .shardTab.unlocking{
      animation: shardUnlockFlicker .62s steps(2, end) 1;
    }

    .shardTab.unlocking::before{
      content: "";
      position: absolute;
      inset: -6px;
      background:
        linear-gradient(90deg, transparent, rgba(255,255,255,.12), transparent),
        linear-gradient(0deg, rgba(255,255,255,.06) 0 1px, transparent 1px 6px);
      mix-blend-mode: screen;
      opacity: .0;
      pointer-events: none;
      animation: shardUnlockScan .58s ease-out 1;
    }

    .shardTab.unlocking::after{
      animation: none;
    }

    .shardViewer{
      position: relative;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 14px;
    }

    .shardViewer.on{ display: flex; }

    .shardFrame{
      position: relative;
      width: min(820px, calc(100% - 10px));
      aspect-ratio: 16 / 9;
      max-height: calc(100% - 10px);
      border: 1px solid rgba(96,143,255,.18);
      background:
        radial-gradient(800px 420px at 20% 0%, rgba(96,143,255,.10), rgba(0,0,0,0) 60%),
        linear-gradient(180deg, rgba(0,0,0,.72), rgba(0,0,0,.90));
      box-shadow:
        0 0 0 1px rgba(0,0,0,.72) inset,
        0 0 34px rgba(96,143,255,.08);
      overflow: hidden;
    }

    .shardFrame::before{
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background:
        linear-gradient(90deg, rgba(96,143,255,.10), rgba(0,0,0,0) 60%),
        repeating-linear-gradient(0deg, rgba(96,143,255,.05), rgba(96,143,255,.05) 1px, transparent 1px, transparent 12px);
      opacity: .55;
    }

    /* mild corner cut like existing HUD panels */
    .shardFrame{
      clip-path: polygon(0 18px, 18px 0, 100% 0, 100% calc(100% - 18px), calc(100% - 18px) 100%, 0 100%);
    }

    /* Removed: shard image should not be used as a window background/frame. */

    .shardContent{
      position: relative;
      z-index: 1;
      height: 100%;
      padding: 28px 34px;
      display: grid;
      grid-template-rows: auto auto 1fr;
      gap: 10px;
    }

    .shardHead{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 12px;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    .shardHeadLeft{
      display: flex;
      align-items: center;
      gap: 10px;
      min-width: 0;
    }

    .shardLogo{
      display: none;
    }

    .shardTabIcon{
      width: 18px;
      height: 18px;
      object-fit: contain;
      opacity: .68;
      mix-blend-mode: screen;
      filter: saturate(.9) contrast(1.05) brightness(.95);
      flex: 0 0 auto;
      user-select: none;
      pointer-events: none;
    }

    .shardTabLabel{
      min-width: 0;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .shardTitle{
      font-size: 16px;
      color: rgba(96,143,255,.90);
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      min-width: 0;
    }

    .shardClose{
      width: 30px;
      height: 24px;
      border: 1px solid rgba(96,143,255,.24);
      background: rgba(0,0,0,.36);
      color: rgba(96,143,255,.86);
      font-family: inherit;
      font-size: 12px;
      letter-spacing: 1px;
      text-transform: uppercase;
      padding: 0;
      cursor: var(--cur-link), pointer;
    }

    .shardClose:hover{
      border-color: rgba(96,143,255,.40);
      color: rgba(96,143,255,.98);
    }

    .shardMeta{
      font-size: 11px;
      letter-spacing: 1.6px;
      text-transform: uppercase;
      color: rgba(96,143,255,.72);
      font-variant-numeric: tabular-nums;
    }

    .shardBody{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 13px;
      line-height: 1.6;
      color: rgba(96,143,255,.86);
      white-space: pre-wrap;
      overflow: auto;
      scrollbar-color: rgba(96,143,255,.35) rgba(0,0,0,.30);
      text-shadow: 0 0 18px rgba(96,143,255,.06);
      padding-right: 6px;
    }

    /* ---- Legacy lore terminal styles below (unused for now) ---- */

    /* Desktop container */
    .loreDesktop{
      position: absolute;
      inset: 12px 14px 14px;
      border: 1px solid rgba(96,143,255,.18);
      background:
        radial-gradient(900px 520px at 22% 0%, rgba(96,143,255,.08), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,.30), rgba(0,0,0,.62));
      box-shadow:
        0 0 0 1px rgba(0,0,0,.72) inset,
        0 0 34px rgba(96,143,255,.06);
      overflow: hidden;
      display: none;
      grid-template-rows: auto 1fr;
    }

    .loreDesktop.on{ display: grid; }

    .loreDeskHead{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 14px;
      padding: 10px 12px;
      border-bottom: 1px solid rgba(96,143,255,.14);
      background:
        linear-gradient(90deg, rgba(96,143,255,.08), rgba(0,0,0,.0) 66%),
        rgba(0,0,0,.20);
      text-transform: uppercase;
      letter-spacing: 1.2px;
      font-size: 11px;
      color: rgba(215,230,255,.60);
    }

    .loreDeskBrand{ display:flex; align-items:center; gap: 8px; min-width: 0; }
    .loreDeskTitle{
      color: rgba(var(--ylRGB), .92);
      font-weight: 700;
      letter-spacing: 1.6px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .loreDeskMeta{
      color: rgba(215,230,255,.50);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 55%;
      font-variant-numeric: tabular-nums;
    }

    .loreFiles{
      padding: 18px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(168px, 1fr));
      gap: 14px;
      align-content: start;
      overflow: auto;
      scrollbar-color: rgba(96,143,255,.35) rgba(0,0,0,.35);
    }

    .loreFile{
      position: relative;
      border: 1px solid rgba(96,143,255,.18);
      background:
        linear-gradient(180deg, rgba(0,0,0,.38), rgba(0,0,0,.62));
      padding: 12px;
      cursor: var(--cur-link), pointer;
      user-select: none;
      box-shadow: 0 0 22px rgba(96,143,255,.06);
      transition: border-color .12s ease, transform .12s ease, box-shadow .12s ease, filter .12s ease;
      min-height: 74px;
      display:flex;
      flex-direction: column;
      justify-content: space-between;
      gap: 8px;
    }

    .loreFile:hover{
      border-color: rgba(var(--ylRGB), .26);
      transform: translateY(-1px);
      box-shadow: 0 0 26px rgba(var(--ylRGB), .06);
    }

    .loreFile.locked{
      cursor: var(--cur-default), default;
      opacity: .55;
      filter: grayscale(.15);
    }

    .loreFile.read{
      border-color: rgba(96,143,255,.10);
      opacity: .82;
    }

    .loreFileName{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12px;
      letter-spacing: .2px;
      color: rgba(215,230,255,.76);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .loreFileMeta{
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 1.3px;
      color: rgba(215,230,255,.44);
      display:flex;
      justify-content: space-between;
      gap: 10px;
    }

    .loreFileTag{ color: rgba(var(--ylRGB), .86); font-weight: 700; }
    .loreFileStatus{ color: rgba(96,143,255,.78); }
    .loreFile.locked .loreFileStatus{ color: rgba(255,140,155,.65); }

    /* Dimmer behind floating window */
    .loreDeskDim{
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,.45);
      opacity: 0;
      pointer-events: none;
      transition: opacity .14s ease;
      z-index: 95;
    }
    .loreDeskDim.on{ opacity: 1; pointer-events: auto; }

    /* Lore notices/warnings as popups */
    .lorePopups{
      position: fixed;
      inset: 0;
      /* Keep popups above the blocker, below the terminal/countdown. */
      z-index: 2147483643;
      pointer-events: none;
    }

    .lorePopup{
      position: absolute;
      right: 16px;
      top: 16px;
      width: min(360px, calc(100vw - 44px));
      border: 1px solid rgba(96,143,255,.22);
      background:
        radial-gradient(560px 220px at 50% 0%, rgba(96,143,255,.14), rgba(0,0,0,0) 60%),
        linear-gradient(180deg, rgba(0,0,0,.72), rgba(0,0,0,.92));
      box-shadow:
        0 0 0 1px rgba(0,0,0,.72) inset,
        0 0 28px rgba(96,143,255,.10);
      padding: 10px 10px 12px;
      pointer-events: auto;
      backdrop-filter: blur(7px);
      -webkit-backdrop-filter: blur(7px);
    }

    .lorePopupHead{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 1.6px;
      font-size: 11px;
      color: rgba(96,143,255,.88);
      font-weight: 400;
    }

    .lorePopupTitle{ min-width: 0; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }

    .lorePopupClose{
      width: 26px;
      height: 22px;
      border: 1px solid rgba(96,143,255,.20);
      background: rgba(0,0,0,.35);
      color: rgba(96,143,255,.82);
      font-family: inherit;
      font-size: 12px;
      letter-spacing: 1px;
      text-transform: uppercase;
      padding: 0;
      cursor: var(--cur-link), pointer;
      flex: 0 0 auto;
    }

    .lorePopupClose:hover{
      border-color: rgba(96,143,255,.35);
      color: rgba(96,143,255,.96);
    }

    .lorePopupBody{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12.5px;
      line-height: 1.55;
      letter-spacing: .1px;
      font-weight: 400;
      color: rgba(96,143,255,.84);
      white-space: pre-wrap;
      word-break: break-word;
    }

    /* Popup theme overrides */
    .lorePopup.theme-blue{
      border-color: rgba(96,143,255,.22);
      box-shadow:
        0 0 0 1px rgba(0,0,0,.72) inset,
        0 0 28px rgba(96,143,255,.10);
    }
    .lorePopup.theme-blue .lorePopupHead{ color: rgba(96,143,255,.88); }
    .lorePopup.theme-blue .lorePopupClose{ border-color: rgba(96,143,255,.20); color: rgba(96,143,255,.82); }
    .lorePopup.theme-blue .lorePopupClose:hover{ border-color: rgba(96,143,255,.35); color: rgba(96,143,255,.96); }
    .lorePopup.theme-blue .lorePopupBody{ color: rgba(96,143,255,.84); }

    .lorePopup.theme-red{
      border-color: rgba(var(--ssHot), .40);
      background:
        radial-gradient(560px 220px at 50% 0%, rgba(var(--ssHot), .16), rgba(0,0,0,0) 60%),
        linear-gradient(180deg, rgba(0,0,0,.82), rgba(0,0,0,.95));
      box-shadow:
        0 0 0 1px rgba(0,0,0,.82) inset,
        0 0 30px rgba(var(--ss), .28);
    }
    .lorePopup.theme-red .lorePopupHead{ color: rgba(var(--ssHot), .90); }
    .lorePopup.theme-red .lorePopupClose{
      border-color: rgba(var(--ssHot), .26);
      color: rgba(var(--ssHot), .84);
      background: rgba(0,0,0,.55);
    }
    .lorePopup.theme-red .lorePopupClose:hover{ border-color: rgba(var(--ssHot), .55); color: rgba(var(--ssHot), .98); }
    .lorePopup.theme-red .lorePopupBody{ color: rgba(var(--ssHot), .86); }

    /* Finale: shutdown countdown popup (must be above the corrupted entry panel). */
    .shutdownPopup{
      position: fixed;
      left: 50%;
      /* Lower on screen (keep out of warning stack). */
      top: 22vh;
      transform: translateX(-50%);
      width: min(520px, calc(100vw - 44px));
      border: 1px solid rgba(var(--ssHot), .52);
      background:
        radial-gradient(720px 260px at 50% 0%, rgba(var(--ssHot), .18), rgba(0,0,0,0) 62%),
        linear-gradient(180deg, rgba(0,0,0,.86), rgba(0,0,0,.96));
      box-shadow:
        0 0 0 1px rgba(0,0,0,.86) inset,
        0 0 46px rgba(var(--ss), .26);
      padding: 12px 12px 12px;
      pointer-events: none;
      z-index: 2147483646;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }

    .shutdownPopupBar{
      height: 8px;
      margin-top: 10px;
      border: 1px solid rgba(var(--ssHot), .40);
      background: rgba(0,0,0,.55);
      box-shadow: 0 0 0 1px rgba(0,0,0,.85) inset;
      overflow: hidden;
    }

    .shutdownPopupBarFill{
      height: 100%;
      width: 0%;
      background: rgba(var(--ssHot), .92);
      box-shadow: 0 0 22px rgba(var(--ss), .22);
      transition: width .06s linear;
      will-change: width;
    }
    .shutdownPopupHead{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 10px;
      text-transform: uppercase;
      letter-spacing: 2px;
      font-size: 11px;
      color: rgba(var(--ssHot), .92);
    }
    .shutdownPopupTitle{ min-width: 0; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
    .shutdownPopupBody{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 18px;
      line-height: 1.2;
      letter-spacing: 1.6px;
      text-transform: uppercase;
      color: rgba(var(--ssHot), .92);
      text-shadow: 0 0 24px rgba(var(--ss), .18);
      font-variant-numeric: tabular-nums;
    }

    /* Finale: "COUNTERHACK" bait button (yellow, teleports on click).
       Keep in its own layer so it stays clickable above the input blocker. */
    .counterhackBaitLayer{
      position: fixed;
      inset: 0;
      z-index: 2147483647;
      pointer-events: auto;
      background: transparent;
    }

    .counterhackBait{
      position: fixed;
      left: 50%;
      top: 72%;
      transform: translate(-50%, -50%);
      pointer-events: auto;
      display: block;
      opacity: 1;
      visibility: visible;
      filter: none;
      isolation: isolate;
    }

    @keyframes counterhackBaitPulse{
      0%, 100%{
        transform: translate(-50%, -50%) scale(1);
        filter: drop-shadow(0 0 10px rgba(var(--ylRGB), .22)) drop-shadow(0 0 32px rgba(var(--ylRGB), .14));
      }
      50%{
        transform: translate(-50%, -50%) scale(1.03);
        filter: drop-shadow(0 0 16px rgba(var(--ylRGB), .32)) drop-shadow(0 0 54px rgba(var(--ylRGB), .20));
      }
    }

    .counterhackBait:not(.glitching){
      animation: counterhackBaitPulse 1.05s ease-in-out infinite;
      will-change: transform, filter;
    }

    .counterhackBaitBtn{
      position: relative;
      border: 2px solid rgba(var(--ylRGB), .98);
      background: rgba(var(--ylRGB), .94);
      color: rgba(0,0,0,.94);
      box-shadow:
        0 0 0 1px rgba(0,0,0,.90) inset,
        0 0 18px rgba(var(--ylRGB), .30),
        0 0 62px rgba(var(--ylRGB), .18);
      padding: 14px 18px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 16px;
      font-weight: 900;
      letter-spacing: 3px;
      text-transform: uppercase;
      cursor: var(--cur-link), pointer;
      user-select: none;
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;

      /* Two-corner cut (Area-Info style): top-left + bottom-right only */
      clip-path: polygon(
        0 12px,
        12px 0,
        100% 0,
        100% calc(100% - 12px),
        calc(100% - 12px) 100%,
        0 100%
      );
    }

    .counterhackBaitBtn::before{
      content:"";
      position:absolute;
      inset: 2px;
      border: 1px solid rgba(0,0,0,.42);
      clip-path: inherit;
      pointer-events: none;
      opacity: .9;
    }

    .counterhackBaitBtn::after{
      content:"";
      position:absolute;
      inset: -8px;
      clip-path: inherit;
      background:
        repeating-linear-gradient(90deg, rgba(0,0,0,.0) 0 10px, rgba(0,0,0,.10) 10px 11px),
        radial-gradient(circle at 20% 0%, rgba(255,255,255,.22), rgba(255,255,255,0) 44%);
      mix-blend-mode: multiply;
      opacity: .16;
      pointer-events: none;
    }

    .counterhackBaitBtn:hover{
      box-shadow:
        0 0 0 1px rgba(0,0,0,.86) inset,
        0 0 26px rgba(var(--ylRGB), .24),
        0 0 84px rgba(var(--ylRGB), .18);
    }

    /* Harder glitch when pressed */
    @keyframes counterhackBaitGlitchOut{
      0%{ opacity: 1; transform: translate3d(0,0,0) skewX(0deg); filter: none; }
      18%{ opacity: .55; transform: translate3d(-8px,2px,0) skewX(-18deg); filter: blur(1.2px) contrast(1.45); }
      35%{ opacity: .35; transform: translate3d(12px,-4px,0) skewX(22deg); filter: blur(1.8px) contrast(1.55); }
      55%{ opacity: .12; transform: translate3d(-14px,6px,0) skewX(-26deg); filter: blur(2.2px) contrast(1.7); }
      100%{ opacity: 0; transform: translate3d(0,0,0) skewX(0deg); filter: none; }
    }

    @keyframes counterhackBaitBtnGlitch{
      0%{ transform: translate3d(0,0,0) skewX(0deg); filter: none; }
      22%{ transform: translate3d(2px,-1px,0) skewX(10deg); filter: brightness(1.07) contrast(1.25); }
      46%{ transform: translate3d(-3px,2px,0) skewX(-14deg); filter: brightness(1.14) contrast(1.35); }
      74%{ transform: translate3d(4px,-2px,0) skewX(12deg); filter: brightness(1.06) contrast(1.22); }
      100%{ transform: translate3d(0,0,0) skewX(0deg); filter: none; }
    }

    .counterhackBait.glitching{
      animation: counterhackBaitGlitchOut .30s steps(2, end) both;
      will-change: transform, opacity, filter;
    }

    .counterhackBaitBtn.glitching{
      animation: counterhackBaitBtnGlitch .30s steps(2, end) both;
      will-change: transform, filter;
    }

    /* Finale palette compliance for the click moment: black + red */
    .counterhackBaitBtn.is-hot{
      border-color: rgba(var(--ssHot), .98);
      background: rgba(0,0,0,.94);
      color: rgba(var(--ssHot), .92);
      text-shadow: 0 0 18px rgba(var(--ss), .18);
      box-shadow:
        0 0 0 1px rgba(0,0,0,.92) inset,
        0 0 18px rgba(var(--ss), .22),
        0 0 62px rgba(var(--ss), .12);
    }

    .counterhackBaitBtn.is-hot::before{
      border-color: rgba(var(--ssHot), .28);
    }

    .counterhackBaitBtn.is-hot::after{
      opacity: .22;
      background:
        repeating-linear-gradient(90deg, rgba(var(--ssHot), .0) 0 10px, rgba(var(--ssHot), .12) 10px 11px),
        radial-gradient(circle at 20% 0%, rgba(255,255,255,.12), rgba(255,255,255,0) 44%);
      mix-blend-mode: screen;
    }

    /* Finale: big red message bar before shutdown. */
    .finaleWelcomeBar{
      position: fixed;
      left: 0;
      right: 0;
      top: 50%;
      transform: translateY(-50%);
      z-index: 2147483646;
      pointer-events: none;
      opacity: 0;
    }

    .finaleWelcomeBar.on{
      opacity: 1;
      animation: finaleWelcomeBarIn .32s steps(2, end) both;
    }

    .finaleWelcomeMsg{
      width: 100%;
      padding: 22px 16px;
      border-top: 2px solid rgba(0,0,0,.95);
      border-bottom: 2px solid rgba(0,0,0,.95);
      /* Pure red fill + black text. */
      background: rgba(var(--ssHot), .98);
      color: rgba(0,0,0,.92);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: clamp(16px, 3.2vw, 34px);
      font-weight: 900;
      letter-spacing: 3px;
      text-transform: uppercase;
      text-align: center;
      text-shadow: none;
      box-shadow:
        0 0 0 1px rgba(0,0,0,.92) inset,
        0 0 46px rgba(var(--ss), .18);
    }

    .finaleWelcomeBar.on{
      opacity: 1;
      animation:
        finaleWelcomeBarIn .32s steps(2, end) both,
        finaleWelcomeBarGlitch 1.05s steps(2, end) infinite;
    }

    @keyframes finaleWelcomeBarIn{
      0%{ opacity: 0; transform: translateY(-50%) skewX(10deg); filter: blur(1.1px) contrast(1.2); }
      40%{ opacity: 1; transform: translateY(-50%) skewX(-12deg); }
      100%{ opacity: 1; transform: translateY(-50%) skewX(0deg); filter: none; }
    }

    @keyframes finaleWelcomeBarGlitch{
      0%{ transform: translateY(-50%) translate3d(0,0,0) skewX(0deg); filter: none; opacity: 1; }
      18%{ transform: translateY(-50%) translate3d(-3px,1px,0) skewX(-12deg); filter: contrast(1.15) saturate(1.2); opacity: .98; }
      22%{ transform: translateY(-50%) translate3d(4px,-1px,0) skewX(12deg); filter: blur(.6px) contrast(1.3); opacity: .82; }
      26%{ transform: translateY(-50%) translate3d(0,0,0) skewX(0deg); filter: none; opacity: 1; }
      78%{ transform: translateY(-50%) translate3d(0,0,0) skewX(0deg); filter: none; opacity: 1; }
      84%{ transform: translateY(-50%) translate3d(2px,0,0) skewX(16deg); filter: contrast(1.18); opacity: .88; }
      100%{ transform: translateY(-50%) translate3d(0,0,0) skewX(0deg); filter: none; opacity: 1; }
    }


    /* Tiny terminal window (reuses .terminal inner visuals) */
    .terminal{
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: min(720px, calc(100vw - 44px));
      height: min(420px, calc(100vh - 160px));
      border: 1px solid rgba(96,143,255,.20);
      background:
        radial-gradient(900px 520px at 22% 0%, rgba(96,143,255,.10), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,.78), rgba(0,0,0,.90));
      box-shadow:
        0 0 0 1px rgba(0,0,0,.72) inset,
        0 0 34px rgba(96,143,255,.08);
      overflow: hidden;
      display: grid;
      grid-template-rows: auto 1fr auto;
      z-index: 60;
    }

  .loreWin{ display:none; z-index: 2147483645; position: fixed; }
  .loreWin.on{ display:grid; }

  /* Finale: make the injected "terminal" match popup panel language (red + black only). */
  .loreWin.corrupted-entry{
    width: min(520px, calc(100vw - 44px));
    height: auto;
    max-height: min(520px, calc(100vh - 160px));
    grid-template-rows: auto 1fr;
    border-color: rgba(var(--ssHot), .40);
    background:
      radial-gradient(560px 220px at 50% 0%, rgba(var(--ssHot), .16), rgba(0,0,0,0) 60%),
      linear-gradient(180deg, rgba(0,0,0,.82), rgba(0,0,0,.95));
    box-shadow:
      0 0 0 1px rgba(0,0,0,.82) inset,
      0 0 34px rgba(var(--ss), .22);
  }

  .loreWin.corrupted-entry .terminalHead{
    border-bottom-color: rgba(var(--ssHot), .22);
    background:
      linear-gradient(90deg, rgba(var(--ssHot), .14), rgba(0,0,0,0) 66%),
      rgba(0,0,0,.62);
  }

  .loreWin.corrupted-entry .terminalBrand{ gap: 10px; }
  .loreWin.corrupted-entry .terminalDot{ display:none; }

  .loreWin.corrupted-entry .terminalMeta{ display:none; }

  /* Remove prompt/footer entirely: this is an "entry" panel, not a terminal. */
  .loreWin.corrupted-entry .terminalFoot{ display:none; }

  .loreWin.corrupted-entry .terminalBody{ padding: 12px 14px 16px; scrollbar-color: rgba(var(--ssHot), .45) rgba(0,0,0,.55); }

  .loreWin.corrupted-entry .terminalBody::-webkit-scrollbar{
    width: 9px;
  }

  .loreWin.corrupted-entry .terminalBody::-webkit-scrollbar-track{
    background: rgba(0,0,0,.62);
    border-left: 1px solid rgba(var(--ssHot), .12);
  }

  .loreWin.corrupted-entry .terminalBody::-webkit-scrollbar-thumb{
    background: rgba(var(--ssHot), .72);
    border: 2px solid rgba(0,0,0,.72);
    box-shadow: 0 0 14px rgba(var(--ss), .16);
  }

  .loreWin.corrupted-entry .terminalBody::-webkit-scrollbar-thumb:hover{
    background: rgba(var(--ssHot), .92);
  }

  .loreWin.corrupted-entry .terminalBody::before{
    background:
      repeating-linear-gradient(0deg, rgba(var(--ssHot), .06) 0px, rgba(var(--ssHot), .06) 1px, rgba(0,0,0,0) 1px, rgba(0,0,0,0) 26px),
      radial-gradient(900px 520px at 16% 0%, rgba(var(--ssHot), .05), rgba(0,0,0,0) 62%);
    opacity: .32;
  }

  .loreWin.corrupted-entry .terminalOutput{ color: rgba(var(--ssHot), .88); text-shadow: 0 0 18px rgba(var(--ss), .14); }


    .loreWinHeadRight{
      display:flex;
      align-items:center;
      gap: 10px;
      min-width: 0;
    }

    .loreWinClose{
      width: 26px;
      height: 22px;
      border: 1px solid rgba(96,143,255,.20);
      background: rgba(0,0,0,.35);
      color: rgba(215,230,255,.70);
      font-family: inherit;
      font-size: 12px;
      letter-spacing: 1px;
      text-transform: uppercase;
      padding: 0;
      cursor: var(--cur-link), pointer;
    }
    .loreWinClose:hover{
      border-color: rgba(var(--ylRGB), .28);
      color: rgba(var(--ylRGB), .92);
    }

    .loreCountdown{
      position: absolute;
      right: 12px;
      bottom: 10px;
      padding: 6px 10px;
      border: 1px solid rgba(255,70,95,.22);
      background: rgba(0,0,0,.46);
      color: rgba(255,140,155,.90);
      text-transform: uppercase;
      letter-spacing: 1.8px;
      font-size: 11px;
      font-variant-numeric: tabular-nums;
      opacity: 0;
      transition: opacity .12s ease;
      z-index: 3;
      pointer-events:none;
    }
    .loreCountdown.on{ opacity: 1; }

    /* Safe mode: minimal + clean */
    .loreSafe{
      position: absolute;
      inset: 12px 14px 14px;
      border: 1px solid rgba(215,230,255,.14);
      background: rgba(0,0,0,.70);
      display: none;
      z-index: 20;
      overflow: hidden;
      grid-template-rows: auto 1fr;
    }

    .loreSafe.on{ display: grid; }

    .loreSafeHead{
      padding: 12px 14px;
      border-bottom: 1px solid rgba(215,230,255,.12);
      color: rgba(215,230,255,.74);
      text-transform: uppercase;
      letter-spacing: 1.6px;
      font-size: 11px;
      display:flex;
      justify-content: space-between;
      gap: 10px;
    }

    .loreSafeTitle{ color: rgba(var(--ylRGB), .90); font-weight: 800; }
    .loreSafeMeta{ color: rgba(215,230,255,.50); }

    .loreSafeBody{
      padding: 16px 16px 26px;
      overflow: auto;
      scrollbar-color: rgba(215,230,255,.22) rgba(0,0,0,.35);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 13px;
      line-height: 1.6;
      color: rgba(215,230,255,.78);
      white-space: pre-wrap;
      word-break: break-word;
      font-variant-numeric: tabular-nums;
    }

    .loreSafeBody .h{
      display:block;
      margin: 10px 0 6px;
      color: rgba(var(--ylRGB), .92);
      font-weight: 800;
      letter-spacing: 1px;
      text-transform: uppercase;
    }

    .loreSafeBody .sep{ display:block; color: rgba(215,230,255,.20); margin: 7px 0; }

    /* Desktop hacked state helper */
    .loreDesktop.is-hacked{ filter: contrast(1.06) saturate(1.08); }
    .loreDesktop.is-hacked .loreDeskMeta{ color: rgba(255,140,155,.70); }
    .loreDesktop.is-hacked .loreFile{ border-color: rgba(255,70,95,.20); }
    .loreDesktop.is-hacked .loreFileTag{ color: rgba(255,140,155,.90); }

    .loreDesktop.is-safe .loreDeskMeta{ color: rgba(215,230,255,.44); }
    .loreDesktop.is-safe .loreFiles{ opacity: .0; pointer-events:none; }

    @keyframes loreFileIn{
      from{ opacity: 0; transform: translateY(6px); }
      to{ opacity: 1; transform: translateY(0); }
    }
    .loreFile.new{ animation: loreFileIn .22s ease both; }

    .terminalHead{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 14px;
      padding: 10px 12px;
      border-bottom: 1px solid rgba(96,143,255,.18);
      background:
        linear-gradient(90deg, rgba(96,143,255,.10), rgba(0,0,0,.0) 66%),
        rgba(0,0,0,.35);
      text-transform: uppercase;
      letter-spacing: 1.2px;
      font-size: 11px;
      color: rgba(215,230,255,.60);
    }

    .terminalBrand{
      display:flex;
      align-items:center;
      gap: 8px;
      min-width: 0;
    }

    .terminalDot{
      width: 9px;
      height: 9px;
      border-radius: 99px;
      border: 1px solid rgba(255,255,255,.20);
      opacity: .75;
      box-shadow: 0 0 10px rgba(0,0,0,.6);
      flex: 0 0 auto;
    }
    .terminalDot.red{ background: rgba(255,75,105,.75); }
    .terminalDot.yl{ background: rgba(var(--ylRGB), .75); }
    .terminalDot.blue{ background: rgba(96,143,255,.75); }

    .terminalTitle{
      color: rgba(var(--ylRGB), .92);
      font-weight: 700;
      letter-spacing: 1.6px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .terminalMeta{
      color: rgba(215,230,255,.50);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 55%;
      font-variant-numeric: tabular-nums;
    }

    .terminalBody{
      position: relative;
      overflow: auto;
      padding: 14px 14px 34px;
      scrollbar-color: rgba(96,143,255,.35) rgba(0,0,0,.35);
    }

    .terminalContinue{
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: none;
      opacity: 0;
      transition: opacity .12s ease;
      z-index: 2;
    }
    .terminalContinue .msg{
      padding: 10px 14px;
      border: 1px solid rgba(96,143,255,.22);
      background: rgba(0,0,0,.46);
      color: rgba(215,230,255,.72);
      text-transform: uppercase;
      letter-spacing: 1.8px;
      font-size: 11px;
      box-shadow: 0 0 26px rgba(96,143,255,.08);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
    }
    @keyframes continuePulse{
      0%, 100%{ opacity: .55; }
      50%{ opacity: .92; }
    }
    .terminal.is-waiting .terminalContinue{ opacity: 1; }
    .terminal.is-waiting .terminalContinue .msg{ animation: continuePulse 1.45s ease-in-out infinite; }

    .terminal.is-injecting .terminalContinue .msg{
      border-color: rgba(255,70,95,.22);
      color: rgba(255,140,155,.86);
      box-shadow: 0 0 26px rgba(255,70,95,.09);
    }

    .terminalBody::before{
      content:"";
      position:absolute;
      inset: 0;
      background:
        repeating-linear-gradient(0deg, rgba(96,143,255,.05) 0px, rgba(96,143,255,.05) 1px, rgba(0,0,0,0) 1px, rgba(0,0,0,0) 26px),
        radial-gradient(900px 520px at 16% 0%, rgba(var(--ylRGB), .05), rgba(0,0,0,0) 62%);
      opacity: .30;
      pointer-events:none;
    }

    .terminalOutput{
      position: relative;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 13px;
      line-height: 1.55;
      letter-spacing: .1px;
      font-weight: 400;
      color: rgba(96,143,255,.86);
      text-shadow: 0 0 18px rgba(96,143,255,.07);
      white-space: pre-wrap;
      word-break: break-word;
      font-variant-numeric: tabular-nums;
    }

    /* Uniform blue output + no bold. */
    .terminalOutput .tok-h1,
    .terminalOutput .tok-meta,
    .terminalOutput .tok-sec,
    .terminalOutput .tok-tag,
    .terminalOutput .tok-warn,
    .terminalOutput .tok-note,
    .terminalOutput .tok-sep,
    .terminalOutput .tok-glitch,
    .terminalOutput .tok-center,
    .terminalOutput .tok-comment{
      color: inherit;
      font-weight: inherit;
      text-shadow: inherit;
      filter: none;
    }

    .terminalOutput .tok-center{ display:block; text-align:center; }

    /* Injection / hack-in block stays red.
       - Normal injected lines: subtle glow
       - <tag> lines: stronger glow + centered + spaced
       - Signature: handled below
    */
    .terminalOutput .tok-inject{
      color: rgba(var(--ssHot), .90);
      text-shadow:
        0 0 12px rgba(var(--ss), .12),
        0 0 30px rgba(0,0,0,.72);
    }

    .terminalOutput .tok-injectTag{
      color: rgba(var(--ssHot), .96);
      display: block;
      text-align: center;
      letter-spacing: 2.4px;
      text-shadow:
        0 0 16px rgba(var(--ss), .18),
        0 0 36px rgba(var(--ss), .22),
        0 0 46px rgba(0,0,0,.76);
    }

    .terminalOutput .tok-injectSig{ color: rgba(var(--ssHot), .86); font-weight: 400; }

    /* Finale signature line: white + more "mysterious" glitch. */
    .terminalOutput .tok-injectSig{
      color: rgba(255,255,255,.92);
      text-shadow:
        0 0 10px rgba(255,255,255,.10),
        0 0 26px rgba(var(--ss), .16);
      filter: contrast(1.1);
      display: inline-block;
    }

    @keyframes finaleSigGlitch{
      0%{ transform: translate3d(0,0,0) skewX(0deg); opacity: 1; }
      18%{ transform: translate3d(1px,0,0) skewX(-10deg); opacity: .85; }
      22%{ transform: translate3d(-2px,1px,0) skewX(12deg); opacity: .55; }
      26%{ transform: translate3d(0,0,0) skewX(0deg); opacity: 1; }
      76%{ transform: translate3d(0,0,0) skewX(0deg); opacity: 1; }
      82%{ transform: translate3d(2px,-1px,0) skewX(16deg); opacity: .65; }
      86%{ transform: translate3d(0,0,0) skewX(0deg); opacity: 1; }
      100%{ transform: translate3d(0,0,0) skewX(0deg); opacity: 1; }
    }

    .terminal.is-injecting .terminalOutput .tok-injectSig{
      animation: finaleSigGlitch 1.15s steps(2, end) infinite;
    }

    .terminal.is-injecting{
      border-color: rgba(var(--ssHot), .42);
      background:
        radial-gradient(900px 520px at 22% 0%, rgba(var(--ssHot), .10), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,.86), rgba(0,0,0,.96));
      box-shadow:
        0 0 0 1px rgba(0,0,0,.82) inset,
        0 0 34px rgba(var(--ss), .20);
    }
    .terminal.is-injecting .terminalHead{
      border-bottom-color: rgba(var(--ssHot), .22);
      background:
        linear-gradient(90deg, rgba(var(--ssHot), .14), rgba(0,0,0,.0) 66%),
        rgba(0,0,0,.62);
      color: rgba(var(--ssHot), .82);
    }

    /* If we're using the popup-entry style, suppress "terminal" chrome. */
    .terminal.is-injecting.corrupted-entry .terminalDot{ display:none; }
    .terminal.is-injecting.corrupted-entry .terminalMeta{ display:none; }
    .terminal.is-injecting.corrupted-entry .terminalFoot{ display:none; }

    /* Only use red + black in injected terminal chrome */
    .terminal.is-injecting .terminalDot.yl{ display:none; }
    .terminal.is-injecting .terminalDot.blue{ display:none; }
    .terminal.is-injecting .terminalDot.red{ background: rgba(var(--ssHot), .78); border-color: rgba(var(--ssHot), .26); }

    .terminal.is-injecting .terminalTitle{ color: rgba(var(--ssHot), .92); }
    .terminal.is-injecting .terminalMeta{ color: rgba(var(--ssHot), .70); }

    .terminal.is-injecting .terminalBody::before{
      background:
        repeating-linear-gradient(0deg, rgba(var(--ssHot), .06) 0px, rgba(var(--ssHot), .06) 1px, rgba(0,0,0,0) 1px, rgba(0,0,0,0) 26px),
        radial-gradient(900px 520px at 16% 0%, rgba(var(--ssHot), .05), rgba(0,0,0,0) 62%);
      opacity: .34;
    }

    .terminal.is-injecting .terminalOutput{ color: rgba(var(--ssHot), .88); text-shadow: 0 0 18px rgba(var(--ss), .14); }
    .terminal.is-injecting .terminalFoot{ border-top-color: rgba(var(--ssHot), .22); color: rgba(var(--ssHot), .72); }
    .terminal.is-injecting .terminalPrompt{ color: rgba(var(--ssHot), .82); }

    @keyframes termJitter{
      0%, 100%{ transform: translateX(0); }
      30%{ transform: translateX(-.6px); }
      60%{ transform: translateX(.8px); }
    }
    @keyframes termFlicker{
      0%, 100%{ opacity: 1; }
      45%{ opacity: .92; }
      47%{ opacity: 1; }
      49%{ opacity: .80; }
      50%{ opacity: 1; }
    }

    .terminal.is-injecting .terminalOutput{
      animation: termFlicker 3.2s infinite;
    }
    .terminal.is-injecting .terminalOutput .tok-inject{
      animation: termJitter 1.8s infinite;
    }
    .terminal.is-injecting .terminalOutput .tok-injectTag{
      /* Keep tags legible and centered; only slight jitter. */
      animation: termJitter 2.2s infinite;
    }

    .terminalFoot{
      padding: 10px 12px;
      border-top: 1px solid rgba(96,143,255,.18);
      background: rgba(0,0,0,.45);
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 1.2px;
      color: rgba(215,230,255,.55);
    }

    .terminalPrompt{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12px;
      text-transform: none;
      letter-spacing: .2px;
      color: rgba(215,230,255,.70);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .promptUser{ color: rgba(96,143,255,.90); }
    .promptPath{ color: rgba(var(--ylRGB), .86); }
    .promptSep{ color: rgba(215,230,255,.45); }

    .cursor{
      display:inline-block;
      width: 9px;
      height: 1.05em;
      margin-left: 6px;
      background: rgba(var(--ylRGB), .85);
      box-shadow: 0 0 12px rgba(var(--ylRGB), .20);
      transform: translateY(2px);
      animation: blink 1s steps(1,end) infinite;
    }
    @keyframes blink{
      0%, 49%{ opacity: 1; }
      50%, 100%{ opacity: 0; }
    }

.loreNextBtn{
  border: 1px solid rgba(var(--ylRGB), .38);
  background:
    radial-gradient(circle at 12% 0%, rgba(var(--ylRGB), .14), transparent 42%),
    rgba(0,0,0,.38);
  color: rgba(var(--ylRGB), .92);
  padding: 8px 12px;
  font-family: inherit;
  font-size: 10px;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  cursor: var(--cur-link), pointer;
  box-shadow: 0 0 18px rgba(var(--ylRGB), .10);
}
.loreNextBtn:hover{
  border-color: rgba(var(--ylRGB), .60);
  box-shadow: 0 0 22px rgba(var(--ylRGB), .14);
}
.loreNextBtn:disabled{
  opacity: .45;
  cursor: var(--cur-default), default;
}

/* Only show after file finishes typing. */
.terminal:not(.is-waiting) .loreNextBtn{ display:none; }
.terminal.is-waiting .loreNextBtn{ display:inline-flex; }
.terminal.is-injecting .loreNextBtn{ border-color: rgba(255,70,95,.40); color: rgba(255,140,155,.92); box-shadow: 0 0 22px rgba(255,70,95,.12); }

.terminalHint{ color: rgba(215,230,255,.40); white-space: nowrap; }
.terminalHint.attn{ color: rgba(var(--ylRGB), .86); text-shadow: 0 0 16px rgba(var(--ylRGB), .10); }
.terminal.is-injecting .terminalHint.attn{ color: rgba(255,120,140,.92); text-shadow: 0 0 16px rgba(255,70,95,.14); }

    .terminal.is-waiting .cursor{ opacity: 0; animation: none; }

    /* Quick transition overlay (used when switching views) */
    .quickload{
      position: fixed;
      inset: 0;
      z-index: 120;
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: none;
      background: rgba(1,6,27,.35);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      opacity: 0;
      transition: opacity .14s ease;
    }
    .quickload.on{
      opacity: 1;
    }
    .quickload .inner{
      width: min(360px, calc(100vw - 48px));
      border: 1px solid rgba(96,143,255,.22);
      background: rgba(0,0,0,.48);
      box-shadow: 0 0 22px rgba(96,143,255,.10);
      padding: 12px;
    }

    /* Blur-only mode: keep the overlay blur, hide the box/bar UI */
    .quickload.bluronly{
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      background: rgba(1,6,27,.25);
    }
    .quickload.bluronly .inner{
      display: none;
    }

    .quickload .label{
      font-size: 11px;
      letter-spacing: 2px;
      text-transform: uppercase;
      color: rgba(96,143,255,.92);
      margin-bottom: 10px;
    }
    .quickload .bar{
      height: 6px;
      border: 1px solid rgba(96,143,255,.24);
      background: rgba(0,0,0,.28);
      overflow: hidden;
    }
    .quickload .fill{
      height: 100%;
      width: 0%;
      background: rgba(var(--ylRGB), .92);
      box-shadow: 0 0 18px rgba(var(--ylRGB), .18);
      transition: width .22s ease;
    }

    /* Finale override: make the loading bar match the red hack palette. */
    .quickload.hack-red{
      background: rgba(0,0,0,.82);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
    .quickload.hack-red .inner{
      border-color: rgba(var(--ssHot), .30);
      background: rgba(0,0,0,.62);
      box-shadow: 0 0 22px rgba(var(--ss), .18);
    }
    .quickload.hack-red .label{ color: rgba(var(--ssHot), .92); }
    .quickload.hack-red .bar{ border-color: rgba(var(--ssHot), .28); }
    .quickload.hack-red .fill{
      background: rgba(var(--ssHot), .92);
      box-shadow: 0 0 18px rgba(var(--ss), .18);
    }
    /* Old HUD filter buttons are deprecated (replaced by left-side menu) */
    #hudFilters{ display:none !important; }

    .termDock{ display:none !important; }
